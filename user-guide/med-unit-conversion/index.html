
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Python Client for Common Longitudinal ICU data Format">
      
      
        <meta name="author" content="CLIF Consortium">
      
      
        <link rel="canonical" href="https://common-longitudinal-icu-data-format.github.io/CLIFpy/user-guide/med-unit-conversion/">
      
      
        <link rel="prev" href="../timezones/">
      
      
        <link rel="next" href="../sofa/">
      
      
      <link rel="icon" href="../../images/clif_logo_red_no_text.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>Medication Unit Conversion - CLIFpy Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.e53b48f4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="maroon" data-md-color-accent="red">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#medication-unit-conversion" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="CLIFpy Documentation" class="md-header__button md-logo" aria-label="CLIFpy Documentation" data-md-component="logo">
      
  <img src="../../images/clif_logo_no_text_white.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CLIFpy Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Medication Unit Conversion
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="maroon" data-md-color-accent="red"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="red"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Common-Longitudinal-ICU-data-Format/CLIFpy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    CLIFpy
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../api/" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="CLIFpy Documentation" class="md-nav__button md-logo" aria-label="CLIFpy Documentation" data-md-component="logo">
      
  <img src="../../images/clif_logo_no_text_white.png" alt="logo">

    </a>
    CLIFpy Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Common-Longitudinal-ICU-data-Format/CLIFpy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    CLIFpy
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quickstart
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Core Features
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Core Features
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../validation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Validation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../outlier-handling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Outlier Handling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../encounter-stitching/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Encounter Stitching
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wide-dataset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Wide Dataset Creation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../timezones/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Working with Timezones
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" checked>
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Advanced Features
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Advanced Features
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Medication Unit Conversion
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Medication Unit Conversion
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#standardize-dose-units-by-medication" class="md-nav__link">
    <span class="md-ellipsis">
      Standardize dose units by medication
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Standardize dose units by medication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#override-option" class="md-nav__link">
    <span class="md-ellipsis">
      Override option
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acceptable-unit-formatting" class="md-nav__link">
    <span class="md-ellipsis">
      Acceptable unit formatting
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#standardize-to-base-units-across-medications" class="md-nav__link">
    <span class="md-ellipsis">
      Standardize to base units across medications
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unit-classification-system" class="md-nav__link">
    <span class="md-ellipsis">
      Unit Classification System
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Unit Classification System">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unit-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Unit Classes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unit-subclasses" class="md-nav__link">
    <span class="md-ellipsis">
      Unit Subclasses
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reference-table" class="md-nav__link">
    <span class="md-ellipsis">
      Reference Table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#important-notes" class="md-nav__link">
    <span class="md-ellipsis">
      Important Notes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-handling" class="md-nav__link">
    <span class="md-ellipsis">
      Error Handling
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Error Handling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-_convert_status-column" class="md-nav__link">
    <span class="md-ellipsis">
      The _convert_status Column
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#failure-handling" class="md-nav__link">
    <span class="md-ellipsis">
      Failure Handling
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#alternative-direct-unit-converter-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Alternative: Direct Unit Converter Usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Alternative: Direct Unit Converter Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#primary-function-convert_dose_units_by_med_category" class="md-nav__link">
    <span class="md-ellipsis">
      Primary Function: convert_dose_units_by_med_category()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#secondary-function-standardize_dose_to_base_units" class="md-nav__link">
    <span class="md-ellipsis">
      Secondary Function: standardize_dose_to_base_units()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#common-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Common Issues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-help" class="md-nav__link">
    <span class="md-ellipsis">
      Getting Help
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-analysis-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      Example Analysis Workflow
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sofa/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SOFA Score Computation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../waterfall/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Respiratory Support Waterfall
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../comorbidity-index/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Comorbidity Index
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/orchestrator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Orchestrator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/base-table/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base Table
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/tables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tables
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/utilities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utilities
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#standardize-dose-units-by-medication" class="md-nav__link">
    <span class="md-ellipsis">
      Standardize dose units by medication
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Standardize dose units by medication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#override-option" class="md-nav__link">
    <span class="md-ellipsis">
      Override option
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acceptable-unit-formatting" class="md-nav__link">
    <span class="md-ellipsis">
      Acceptable unit formatting
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#standardize-to-base-units-across-medications" class="md-nav__link">
    <span class="md-ellipsis">
      Standardize to base units across medications
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unit-classification-system" class="md-nav__link">
    <span class="md-ellipsis">
      Unit Classification System
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Unit Classification System">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unit-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Unit Classes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unit-subclasses" class="md-nav__link">
    <span class="md-ellipsis">
      Unit Subclasses
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reference-table" class="md-nav__link">
    <span class="md-ellipsis">
      Reference Table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#important-notes" class="md-nav__link">
    <span class="md-ellipsis">
      Important Notes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-handling" class="md-nav__link">
    <span class="md-ellipsis">
      Error Handling
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Error Handling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-_convert_status-column" class="md-nav__link">
    <span class="md-ellipsis">
      The _convert_status Column
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#failure-handling" class="md-nav__link">
    <span class="md-ellipsis">
      Failure Handling
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#alternative-direct-unit-converter-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Alternative: Direct Unit Converter Usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Alternative: Direct Unit Converter Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#primary-function-convert_dose_units_by_med_category" class="md-nav__link">
    <span class="md-ellipsis">
      Primary Function: convert_dose_units_by_med_category()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#secondary-function-standardize_dose_to_base_units" class="md-nav__link">
    <span class="md-ellipsis">
      Secondary Function: standardize_dose_to_base_units()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#common-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Common Issues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-help" class="md-nav__link">
    <span class="md-ellipsis">
      Getting Help
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-analysis-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      Example Analysis Workflow
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="medication-unit-conversion">Medication Unit Conversion<a class="headerlink" href="#medication-unit-conversion" title="Permanent link">&para;</a></h1>
<p>CLIFpy provides robust medication dose unit conversion functionality to standardize medication dosing across different unit systems. This is essential for clinical data analysis where medications may be recorded in various units across different systems.</p>
<h2 id="standardize-dose-units-by-medication">Standardize dose units by medication<a class="headerlink" href="#standardize-dose-units-by-medication" title="Permanent link">&para;</a></h2>
<p>In the most common use cases, we want to <strong>standardize dose units by medication and pattern of administration</strong> -- all propofol doses to be presented in mcg/kg/min in the continuous table and in mcg in the intermittent table, for example.</p>
<p>To achieve this, simply call one of the two <code>convert_dose_units_*</code> functions (one for continuous and one for intermittent) from the CLIF orchestrator and provide <strong>a dictionary mapping of medication categories to their preferred units</strong>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">clifpy.clif_orchestrator</span><span class="w"> </span><span class="kn">import</span> <span class="n">ClifOrchestrator</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">co</span> <span class="o">=</span> <span class="n">ClifOrchestrator</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="s2">&quot;config/config.yaml&quot;</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">preferred_units_cont</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="s2">&quot;propofol&quot;</span><span class="p">:</span> <span class="s2">&quot;mcg/min&quot;</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="s2">&quot;fentanyl&quot;</span><span class="p">:</span> <span class="s2">&quot;mcg/hr&quot;</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="s2">&quot;insulin&quot;</span><span class="p">:</span> <span class="s2">&quot;u/hr&quot;</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="s2">&quot;midazolam&quot;</span><span class="p">:</span> <span class="s2">&quot;mg/hr&quot;</span><span class="p">,</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="s2">&quot;heparin&quot;</span><span class="p">:</span> <span class="s2">&quot;u/min&quot;</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="p">}</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="n">co</span><span class="o">.</span><span class="n">convert_dose_units_for_continuous_meds</span><span class="p">(</span><span class="n">preferred_units</span><span class="o">=</span><span class="n">preferred_units_cont</span><span class="p">)</span>
</code></pre></div>
<h3 id="returns">Returns<a class="headerlink" href="#returns" title="Permanent link">&para;</a></h3>
<p>Under the hood, this function automatically loads and uses the medication and vitals tables to generate two dataframes that are saved to the corresponding medication table instance by default:</p>
<ol>
<li><strong><code>co.medication_admin_continuous.df_converted</code></strong> gives the updated medication table with the new columns appended:
   - <code>weight_kg</code>: the most recent weight relative to the <code>admin_dttm</code> pulled from the <code>vitals</code> table.
   - <code>_clean_unit</code>: cleaned source unit string where both 'U/h' and 'units / hour' would be standardized to 'u/hr', for example.
   - <code>_unit_class</code>: distinguishes where the source unit is an amount (e.g. 'mcg'), a 'rate' (e.g. 'mcg/hr'), or 'unrecognized'.
   - <code>_convert_status</code>: documents whether the conversion is a "success" or, in the case of failure, the reason for failure, e.g. 'cannot convert amount to rate' for rows of propofol in 'mcg' that the users want to convert to 'mcg/kg/min'.
   - <code>med_dose_converted</code>, <code>med_dose_unit_converted</code>: the converted results if the <code>_convert_status</code> is 'success', or fall back to the original <code>med_dose</code> and <code>_clean_unit</code> if failure.</li>
</ol>
<p><em>Note: the following demo output omits some rows and columns for display purposes</em></p>
<ol start="2">
<li><strong><code>co.medication_admin_continuous.conversion_counts</code></strong> shows an aggregated summary of which source units of which <code>med_category</code> are converted to which preferred units -- and their frequency counts. A useful quality check would be to filter for all the <code>_convert_status</code> that are not 'success.'</li>
</ol>
<p>To access the results directly instead of from the table instance, turn off the <code>save_to_table</code> argument:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">cont_converted</span><span class="p">,</span> <span class="n">cont_counts</span> <span class="o">=</span> <span class="n">co</span><span class="o">.</span><span class="n">convert_dose_units_for_continuous_meds</span><span class="p">(</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>    <span class="n">preferred_units</span><span class="o">=</span><span class="n">preferred_units_cont</span><span class="p">,</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>    <span class="n">save_to_table</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="p">)</span>
</code></pre></div>
<h3 id="override-option">Override option<a class="headerlink" href="#override-option" title="Permanent link">&para;</a></h3>
<p>The function automatically parses whether the provided <code>med_categories</code> and preferred units in the dictionary are acceptable and return errors or warnings when they are not. To override any code-breaking error such as an unidentified <code>med_category</code> or preferred unit string, turn on the arg <code>override=True</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">co</span><span class="o">.</span><span class="n">convert_dose_units_for_continuous_meds</span><span class="p">(</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>    <span class="n">preferred_units</span><span class="o">=</span><span class="n">preferred_units_cont</span><span class="p">,</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>    <span class="n">override</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="p">)</span>
</code></pre></div>
<h3 id="acceptable-unit-formatting">Acceptable unit formatting<a class="headerlink" href="#acceptable-unit-formatting" title="Permanent link">&para;</a></h3>
<p>The unit strings in <code>preferred_units</code> dictionary need to be formatted a certain way for them to be accepted. (The original source unit strings in <code>med_dose_unit</code> do <em>not</em> face such restrictions. Both 'mL' and 'milliliter' in <code>med_dose_unit</code> can be correctly parsed as 'ml', for example.)</p>
<p>For a list of acceptable preferred units:</p>
<ul>
<li><strong>amount:</strong></li>
<li>mass: <code>mcg</code>, <code>mg</code>, <code>ng</code>, <code>g</code></li>
<li>volume: <code>ml</code>, <code>l</code></li>
<li>
<p>unit: <code>mu</code>, <code>u</code></p>
</li>
<li>
<p><strong>weight:</strong> <code>/kg</code>, <code>/lb</code></p>
</li>
<li>
<p><strong>time:</strong> <code>/hr</code>, <code>/min</code></p>
</li>
<li>
<p><strong>rate:</strong> a combination of amount, weight, and time, e.g. 'mcg/kg/min', 'u/hr'.</p>
</li>
<li>the unit can be either weight-adjusted or not -- that is, both 'mcg/kg/min' and 'mcg/min' are acceptable. When no weight is available from the <code>vitals</code> table to enable conversion between weight-adjusted and weight-less units, an error will be returned.</li>
</ul>
<p>All strings should be in lower case with no whitespaces in between.</p>
<h2 id="standardize-to-base-units-across-medications">Standardize to base units across medications<a class="headerlink" href="#standardize-to-base-units-across-medications" title="Permanent link">&para;</a></h2>
<p>In rarer cases, one might prefer all applicable units of the same class be collapsed onto the same scale across medications, e.g. both 'mcg/kg/min' and 'mg/hour' would be converted to the same 'mcg/min' -- referred to here as the "base unit" -- across all medications applicable.</p>
<p>To enable this, turn on the <code>show_intermediate=True</code> argument:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">cont_converted_detailed</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">co</span><span class="o">.</span><span class="n">convert_dose_units_for_continuous_meds</span><span class="p">(</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>    <span class="n">preferred_units</span><span class="o">=</span><span class="n">preferred_units_cont</span><span class="p">,</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>    <span class="n">save_to_table</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>    <span class="n">show_intermediate</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="p">)</span>
</code></pre></div>
<p>This would append a series of additional columns that were the intermediate results generated during the conversion, including the <code>_base_dose</code> and <code>_base_unit</code>.</p>
<p>The set of base units are:</p>
<ul>
<li><strong>amount</strong>: <code>mcg</code>, <code>ml</code>, <code>u</code></li>
<li><strong>time</strong>: <code>/min</code></li>
<li><strong>rate</strong>: a combination of amount and time, e.g. <code>mcg/min</code>, <code>u/min</code>.</li>
<li>Note that all base units would be weight-less.</li>
</ul>
<h2 id="unit-classification-system">Unit Classification System<a class="headerlink" href="#unit-classification-system" title="Permanent link">&para;</a></h2>
<h3 id="unit-classes">Unit Classes<a class="headerlink" href="#unit-classes" title="Permanent link">&para;</a></h3>
<ul>
<li><strong><code>rate</code></strong>: Dose per time units (e.g., mcg/min, ml/hr, u/kg/hr)</li>
<li><strong><code>amount</code></strong>: Total dose units (e.g., mcg, ml, u)</li>
<li><strong><code>unrecognized</code></strong>: Units that cannot be parsed or converted</li>
</ul>
<h3 id="unit-subclasses">Unit Subclasses<a class="headerlink" href="#unit-subclasses" title="Permanent link">&para;</a></h3>
<ul>
<li><strong><code>mass</code></strong>: Weight-based units (mcg, mg, ng, g)</li>
<li><strong><code>volume</code></strong>: Volume-based units (ml, l)</li>
<li><strong><code>unit</code></strong>: Unit-based dosing (u, mu)</li>
<li><strong><code>unrecognized</code></strong>: Units that don't fit standard categories</li>
</ul>
<p>Unit class and subclass compatibility determines whether conversions are allowed. For example:</p>
<ul>
<li>
<p>✅ <code>rate</code> → <code>rate</code> (same class)</p>
</li>
<li>
<p>✅ <code>mass</code> → <code>mass</code> (same subclass)</p>
</li>
<li>
<p>❌ <code>rate</code> → <code>amount</code> (different class)</p>
</li>
<li>
<p>❌ <code>mass</code> → <code>volume</code> (different subclass)</p>
</li>
</ul>
<h3 id="reference-table">Reference Table<a class="headerlink" href="#reference-table" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>unit class</th>
<th>unit subclass</th>
<th>_clean_unit</th>
<th>acceptable source <code>med_dose_unit</code> examples</th>
<th>_base_unit</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Amount Units</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>amount</td>
<td>mass</td>
<td>mcg</td>
<td>MCG, µg, μg, ug</td>
<td>mcg</td>
</tr>
<tr>
<td>amount</td>
<td>mass</td>
<td>mg</td>
<td>MG, milligram</td>
<td>mcg</td>
</tr>
<tr>
<td>amount</td>
<td>mass</td>
<td>ng</td>
<td>NG, nanogram</td>
<td>mcg</td>
</tr>
<tr>
<td>amount</td>
<td>mass</td>
<td>g</td>
<td>G, gram, grams</td>
<td>mcg</td>
</tr>
<tr>
<td>amount</td>
<td>volume</td>
<td>ml</td>
<td>mL, milliliter, milliliters</td>
<td>ml</td>
</tr>
<tr>
<td>amount</td>
<td>volume</td>
<td>l</td>
<td>L, liter, liters, litre, litres</td>
<td>ml</td>
</tr>
<tr>
<td>amount</td>
<td>unit</td>
<td>u</td>
<td>U, unit, units</td>
<td>u</td>
</tr>
<tr>
<td>amount</td>
<td>unit</td>
<td>mu</td>
<td>MU, milliunit, milliunits, milli-unit, milli-units</td>
<td>u</td>
</tr>
<tr>
<td><strong>Rate Units</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>rate</td>
<td>mass</td>
<td>mcg/min</td>
<td>MCG/MIN, µg/min, μg/min, mcg/minute, micrograms/minute</td>
<td>mcg/min</td>
</tr>
<tr>
<td>rate</td>
<td>mass</td>
<td>mcg/hr</td>
<td>MCG/HR, µg/hr, μg/hr, mcg/hour, micrograms/hour</td>
<td>mcg/min</td>
</tr>
<tr>
<td>rate</td>
<td>mass</td>
<td>mcg/kg/min</td>
<td>MCG/KG/MIN, µg/kg/min, mcg/kg/minute</td>
<td>mcg/min</td>
</tr>
<tr>
<td>rate</td>
<td>mass</td>
<td>mcg/kg/hr</td>
<td>MCG/KG/HR, µg/kg/hr, mcg/kg/hour</td>
<td>mcg/min</td>
</tr>
<tr>
<td>rate</td>
<td>mass</td>
<td>mcg/lb/min</td>
<td>MCG/LB/MIN, µg/lb/min, mcg/lb/minute</td>
<td>mcg/min</td>
</tr>
<tr>
<td>rate</td>
<td>mass</td>
<td>mcg/lb/hr</td>
<td>MCG/LB/HR, µg/lb/hr, mcg/lb/hour</td>
<td>mcg/min</td>
</tr>
<tr>
<td>rate</td>
<td>volume</td>
<td>ml/min</td>
<td>mL/min, ml/m, milliliter/minute</td>
<td>ml/min</td>
</tr>
<tr>
<td>rate</td>
<td>volume</td>
<td>ml/hr</td>
<td>mL/hr, ml/h, milliliter/hour, milliliters/hour, millilitres/hour</td>
<td>ml/min</td>
</tr>
<tr>
<td>rate</td>
<td>volume</td>
<td>ml/kg/min</td>
<td>mL/kg/min, milliliter/kg/minute</td>
<td>ml/min</td>
</tr>
<tr>
<td>rate</td>
<td>volume</td>
<td>ml/kg/hr</td>
<td>mL/kg/hr, milliliter/kg/hour</td>
<td>ml/min</td>
</tr>
<tr>
<td>rate</td>
<td>volume</td>
<td>ml/lb/min</td>
<td>mL/lb/min, milliliter/lb/minute</td>
<td>ml/min</td>
</tr>
<tr>
<td>rate</td>
<td>volume</td>
<td>ml/lb/hr</td>
<td>mL/lb/hr, milliliter/lb/hour</td>
<td>ml/min</td>
</tr>
<tr>
<td>rate</td>
<td>unit</td>
<td>u/min</td>
<td>U/min, units/minute, unit/minute</td>
<td>u/min</td>
</tr>
<tr>
<td>rate</td>
<td>unit</td>
<td>u/hr</td>
<td>U/hr, units/hour, unit/hour</td>
<td>u/min</td>
</tr>
<tr>
<td>rate</td>
<td>unit</td>
<td>u/kg/min</td>
<td>U/kg/min, units/kg/minute</td>
<td>u/min</td>
</tr>
<tr>
<td>rate</td>
<td>unit</td>
<td>u/kg/hr</td>
<td>U/kg/hr, u/kg/h, units/kg/hour</td>
<td>u/min</td>
</tr>
<tr>
<td>rate</td>
<td>unit</td>
<td>u/lb/min</td>
<td>U/lb/min, units/lb/minute</td>
<td>u/min</td>
</tr>
<tr>
<td>rate</td>
<td>unit</td>
<td>u/lb/hr</td>
<td>U/lb/hr, units/lb/hour, unit/lb/hr</td>
<td>u/min</td>
</tr>
</tbody>
</table>
<h3 id="important-notes">Important Notes<a class="headerlink" href="#important-notes" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>_clean_unit</strong>: The exact format you must use when specifying preferred units</li>
<li><strong>Acceptable Variations</strong>: Raw <code>med_dose_unit</code> strings in your original DataFrame that the converter can detect and clean (these are NOT acceptable formats for preferred units)</li>
<li><strong>_base_unit</strong>: The standardized unit all conversions target (mcg/min, ml/min, u/min for rates; mcg, ml, u for amounts)</li>
</ul>
<h2 id="error-handling">Error Handling<a class="headerlink" href="#error-handling" title="Permanent link">&para;</a></h2>
<h3 id="the-_convert_status-column">The <code>_convert_status</code> Column<a class="headerlink" href="#the-_convert_status-column" title="Permanent link">&para;</a></h3>
<p>After conversion, each record includes a <code>_convert_status</code> field indicating the outcome:</p>
<ul>
<li><strong><code>success</code></strong>: Conversion completed successfully</li>
<li><strong><code>original unit is missing</code></strong>: No unit provided in source data</li>
<li><strong><code>original unit [unit] is not recognized</code></strong>: Input unit cannot be parsed</li>
<li><strong><code>user-preferred unit [unit] is not recognized</code></strong>: Target unit is invalid</li>
<li><strong><code>cannot convert [class1] to [class2]</code></strong>: Incompatible unit classes (e.g., rate → amount)</li>
<li><strong><code>cannot convert [subclass1] to [subclass2]</code></strong>: Incompatible unit subclasses (e.g., mass → volume)</li>
<li><strong><code>cannot convert to a weighted unit if weight_kg is missing</code></strong>: Weight-based conversion attempted without patient weight</li>
</ul>
<h3 id="failure-handling">Failure Handling<a class="headerlink" href="#failure-handling" title="Permanent link">&para;</a></h3>
<p>When conversion fails:
- <code>med_dose_converted</code> = original <code>_base_dose</code> (or original dose if base conversion failed)
- <code>med_dose_unit_converted</code> = <code>_clean_unit</code> (or original unit if cleaning failed)</p>
<h2 id="alternative-direct-unit-converter-usage">Alternative: Direct Unit Converter Usage<a class="headerlink" href="#alternative-direct-unit-converter-usage" title="Permanent link">&para;</a></h2>
<p>For advanced users who need more control or want to use the unit converter directly without the ClifOrchestrator:</p>
<h3 id="primary-function-convert_dose_units_by_med_category">Primary Function: <code>convert_dose_units_by_med_category()</code><a class="headerlink" href="#primary-function-convert_dose_units_by_med_category" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">clifpy.utils.unit_converter</span><span class="w"> </span><span class="kn">import</span> <span class="n">convert_dose_units_by_med_category</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="c1"># Load your medication data</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="n">med_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s1">&#39;clifpy/data/clif_demo/clif_medication_admin_continuous.parquet&#39;</span><span class="p">)</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="c1"># Define preferred units for each medication</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="n">preferred_units</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>    <span class="s1">&#39;propofol&#39;</span><span class="p">:</span> <span class="s1">&#39;mcg/kg/min&#39;</span><span class="p">,</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>    <span class="s1">&#39;fentanyl&#39;</span><span class="p">:</span> <span class="s1">&#39;mcg/hr&#39;</span><span class="p">,</span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>    <span class="s1">&#39;insulin&#39;</span><span class="p">:</span> <span class="s1">&#39;u/hr&#39;</span><span class="p">,</span>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>    <span class="s1">&#39;midazolam&#39;</span><span class="p">:</span> <span class="s1">&#39;mg/hr&#39;</span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="p">}</span>
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="c1"># Convert units</span>
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="n">converted_df</span><span class="p">,</span> <span class="n">summary_df</span> <span class="o">=</span> <span class="n">convert_dose_units_by_med_category</span><span class="p">(</span>
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>    <span class="n">med_df</span><span class="o">=</span><span class="n">med_df</span><span class="p">,</span>
<a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a>    <span class="n">preferred_units</span><span class="o">=</span><span class="n">preferred_units</span><span class="p">,</span>
<a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a>    <span class="n">override</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a><span class="p">)</span>
</code></pre></div>
<h3 id="secondary-function-standardize_dose_to_base_units">Secondary Function: <code>standardize_dose_to_base_units()</code><a class="headerlink" href="#secondary-function-standardize_dose_to_base_units" title="Permanent link">&para;</a></h3>
<p>This function is for advanced users who need to standardize all units to a base set without medication-specific preferences.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">clifpy.utils.unit_converter</span><span class="w"> </span><span class="kn">import</span> <span class="n">standardize_dose_to_base_units</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="c1"># Standardize to base units only</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="n">base_df</span><span class="p">,</span> <span class="n">counts_df</span> <span class="o">=</span> <span class="n">standardize_dose_to_base_units</span><span class="p">(</span><span class="n">med_df</span><span class="p">)</span>
</code></pre></div>
<h2 id="best-practices">Best Practices<a class="headerlink" href="#best-practices" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>Check conversion status</strong> after processing to identify failed conversions</li>
<li><strong>Use exact _clean_unit formats</strong> when specifying preferred units</li>
<li><strong>Review the conversion counts summary DataFrame</strong> to understand conversion patterns and identify data quality issues</li>
<li><strong>Test with override=True</strong> first to see all potential issues before requiring strict validation</li>
<li><strong>Validate your preferred_units dictionary</strong> against the acceptable units table above</li>
</ol>
<h2 id="troubleshooting">Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permanent link">&para;</a></h2>
<h3 id="common-issues">Common Issues<a class="headerlink" href="#common-issues" title="Permanent link">&para;</a></h3>
<p><strong>Issue</strong>: "Cannot convert rate to amount"
    - <strong>Solution</strong>: Ensure unit classes match (rate→rate, amount→amount)</p>
<p><strong>Issue</strong>: "Cannot convert mass to volume"
    - <strong>Solution</strong>: Ensure unit subclasses match (mass→mass, volume→volume)</p>
<p><strong>Issue</strong>: "User-preferred unit [unit] is not recognized"
    - <strong>Solution</strong>: Use exact <code>_clean_unit</code> format from the reference table above</p>
<p><strong>Issue</strong>: Weight-based conversions failing
    - <strong>Solution</strong>: Ensure <code>weight_kg</code> column exists in your DataFrame or is available in vitals data</p>
<p><strong>Issue</strong>: "Cannot convert to a weighted unit if weight_kg is missing"
    - <strong>Solution</strong>: Provide patient weights in the vitals table or med_df</p>
<h3 id="getting-help">Getting Help<a class="headerlink" href="#getting-help" title="Permanent link">&para;</a></h3>
<p>If you encounter units not in the reference table or unexpected conversion failures:</p>
<ol>
<li>Check the <code>_convert_status</code> column for specific error messages</li>
<li>Review the summary DataFrame for patterns in failed conversions</li>
<li>Use <code>override=True</code> to see warnings instead of stopping on errors</li>
<li>Consult the API reference for detailed function documentation</li>
</ol>
<h2 id="example-analysis-workflow">Example Analysis Workflow<a class="headerlink" href="#example-analysis-workflow" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1"># 1. Basic conversion</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="n">converted_df</span><span class="p">,</span> <span class="n">summary_df</span> <span class="o">=</span> <span class="n">co</span><span class="o">.</span><span class="n">convert_dose_units_for_continuous_meds</span><span class="p">(</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>    <span class="n">preferred_units</span><span class="o">=</span><span class="n">preferred_units_cont</span><span class="p">,</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>    <span class="n">save_to_table</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="p">)</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="c1"># 2. Check conversion success</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total records: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">converted_df</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successful conversions: </span><span class="si">{</span><span class="p">(</span><span class="n">converted_df</span><span class="p">[</span><span class="s1">&#39;_convert_status&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="c1"># 3. Analyze conversion patterns</span>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="n">summary_analysis</span> <span class="o">=</span> <span class="n">summary_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;med_category&#39;</span><span class="p">,</span> <span class="s1">&#39;_convert_status&#39;</span><span class="p">])[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Conversion summary by medication:&quot;</span><span class="p">)</span>
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="nb">print</span><span class="p">(</span><span class="n">summary_analysis</span><span class="p">)</span>
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>
<a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="c1"># 4. Check for problematic units</span>
<a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a><span class="n">problematic_units</span> <span class="o">=</span> <span class="n">summary_df</span><span class="p">[</span><span class="n">summary_df</span><span class="p">[</span><span class="s1">&#39;_convert_status&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;success&#39;</span><span class="p">]</span>
<a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">nUnits requiring attention:&quot;</span><span class="p">)</span>
<a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a><span class="nb">print</span><span class="p">(</span><span class="n">problematic_units</span><span class="p">[[</span><span class="s1">&#39;med_dose_unit&#39;</span><span class="p">,</span> <span class="s1">&#39;_convert_status&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">]])</span>
</code></pre></div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/Common-Longitudinal-ICU-data-Format/CLIFpy" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../js/dark-mode-default.js"></script>
      
    
  </body>
</html>