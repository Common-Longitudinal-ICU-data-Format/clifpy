
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Python Client for Common Longitudinal ICU data Format">
      
      
        <meta name="author" content="CLIF Consortium">
      
      
        <link rel="canonical" href="https://common-longitudinal-icu-data-format.github.io/CLIFpy/api/orchestrator/">
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../base-table/">
      
      
      <link rel="icon" href="../../images/clif_logo_red_no_text.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>Orchestrator - CLIFpy Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.e53b48f4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="maroon" data-md-color-accent="red">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cliforchestrator" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="CLIFpy Documentation" class="md-header__button md-logo" aria-label="CLIFpy Documentation" data-md-component="logo">
      
  <img src="../../images/clif_logo_no_text_white.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CLIFpy Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Orchestrator
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="maroon" data-md-color-accent="red"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="red"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Common-Longitudinal-ICU-data-Format/CLIFpy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    CLIFpy
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../user-guide/" class="md-tabs__link">
          
  
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="CLIFpy Documentation" class="md-nav__button md-logo" aria-label="CLIFpy Documentation" data-md-component="logo">
      
  <img src="../../images/clif_logo_no_text_white.png" alt="logo">

    </a>
    CLIFpy Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Common-Longitudinal-ICU-data-Format/CLIFpy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    CLIFpy
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quickstart
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Core Features
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Core Features
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/validation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Validation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/outlier-handling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Outlier Handling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/encounter-stitching/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Encounter Stitching
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/wide-dataset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Wide Dataset Creation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/timezones/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Working with Timezones
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Advanced Features
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Advanced Features
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/med-unit-conversion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Medication Unit Conversion
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/sofa/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SOFA Score Computation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/waterfall/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Respiratory Support Waterfall
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/comorbidity-index/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Comorbidity Index
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Orchestrator
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Orchestrator
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#clifpy.clif_orchestrator.ClifOrchestrator" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ClifOrchestrator
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ClifOrchestrator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#clifpy.clif_orchestrator.ClifOrchestrator.compute_sofa_scores" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute_sofa_scores
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clifpy.clif_orchestrator.ClifOrchestrator.convert_dose_units_for_continuous_meds" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;convert_dose_units_for_continuous_meds
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clifpy.clif_orchestrator.ClifOrchestrator.convert_dose_units_for_intermittent_meds" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;convert_dose_units_for_intermittent_meds
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clifpy.clif_orchestrator.ClifOrchestrator.convert_wide_to_hourly" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;convert_wide_to_hourly
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clifpy.clif_orchestrator.ClifOrchestrator.create_wide_dataset" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;create_wide_dataset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clifpy.clif_orchestrator.ClifOrchestrator.from_config" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clifpy.clif_orchestrator.ClifOrchestrator.get_encounter_mapping" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_encounter_mapping
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clifpy.clif_orchestrator.ClifOrchestrator.get_loaded_tables" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_loaded_tables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clifpy.clif_orchestrator.ClifOrchestrator.get_sys_resource_info" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_sys_resource_info
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clifpy.clif_orchestrator.ClifOrchestrator.get_tables_obj_list" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_tables_obj_list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clifpy.clif_orchestrator.ClifOrchestrator.initialize" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;initialize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clifpy.clif_orchestrator.ClifOrchestrator.load_table" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load_table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clifpy.clif_orchestrator.ClifOrchestrator.validate_all" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;validate_all
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../base-table/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base Table
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tables
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utilities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utilities
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#clifpy.clif_orchestrator.ClifOrchestrator" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ClifOrchestrator
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ClifOrchestrator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#clifpy.clif_orchestrator.ClifOrchestrator.compute_sofa_scores" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;compute_sofa_scores
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clifpy.clif_orchestrator.ClifOrchestrator.convert_dose_units_for_continuous_meds" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;convert_dose_units_for_continuous_meds
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clifpy.clif_orchestrator.ClifOrchestrator.convert_dose_units_for_intermittent_meds" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;convert_dose_units_for_intermittent_meds
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clifpy.clif_orchestrator.ClifOrchestrator.convert_wide_to_hourly" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;convert_wide_to_hourly
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clifpy.clif_orchestrator.ClifOrchestrator.create_wide_dataset" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;create_wide_dataset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clifpy.clif_orchestrator.ClifOrchestrator.from_config" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clifpy.clif_orchestrator.ClifOrchestrator.get_encounter_mapping" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_encounter_mapping
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clifpy.clif_orchestrator.ClifOrchestrator.get_loaded_tables" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_loaded_tables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clifpy.clif_orchestrator.ClifOrchestrator.get_sys_resource_info" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_sys_resource_info
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clifpy.clif_orchestrator.ClifOrchestrator.get_tables_obj_list" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_tables_obj_list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clifpy.clif_orchestrator.ClifOrchestrator.initialize" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;initialize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clifpy.clif_orchestrator.ClifOrchestrator.load_table" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load_table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clifpy.clif_orchestrator.ClifOrchestrator.validate_all" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;validate_all
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="cliforchestrator">ClifOrchestrator<a class="headerlink" href="#cliforchestrator" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-class">



<h2 id="clifpy.clif_orchestrator.ClifOrchestrator" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">clifpy.clif_orchestrator.ClifOrchestrator</span>


<a href="#clifpy.clif_orchestrator.ClifOrchestrator" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">ClifOrchestrator</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data_directory</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">timezone</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_directory</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stitch_encounter</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stitch_time_interval</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">


        <p>Orchestrator class for managing multiple CLIF table objects.</p>
<p>This class provides a centralized interface for loading, managing,
and validating multiple CLIF tables with consistent configuration.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="clifpy.clif_orchestrator.ClifOrchestrator.config_path">config_path</span></code></td>
            <td>
                  <code>(<span title="str">str</span>, <span title="optional">optional</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to configuration JSON file</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="clifpy.clif_orchestrator.ClifOrchestrator.data_directory">data_directory</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the directory containing data files</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="clifpy.clif_orchestrator.ClifOrchestrator.filetype">filetype</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of data file (csv, parquet, etc.)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="clifpy.clif_orchestrator.ClifOrchestrator.timezone">timezone</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Timezone for datetime columns</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="clifpy.clif_orchestrator.ClifOrchestrator.output_directory">output_directory</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory for saving output files and logs</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="clifpy.clif_orchestrator.ClifOrchestrator.stitch_encounter">stitch_encounter</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to stitch encounters within time interval</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="clifpy.clif_orchestrator.ClifOrchestrator.stitch_time_interval">stitch_time_interval</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hours between discharge and next admission to consider encounters linked</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="clifpy.clif_orchestrator.ClifOrchestrator.encounter_mapping">encounter_mapping</span></code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mapping of hospitalization_id to encounter_block (after stitching)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="clifpy.clif_orchestrator.ClifOrchestrator.patient">patient</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            clifpy.tables.patient.Patient" href="../tables/#clifpy.tables.patient.Patient">Patient</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Patient table object</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="clifpy.clif_orchestrator.ClifOrchestrator.hospitalization">hospitalization</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            clifpy.tables.hospitalization.Hospitalization" href="../tables/#clifpy.tables.hospitalization.Hospitalization">Hospitalization</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hospitalization table object</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="clifpy.clif_orchestrator.ClifOrchestrator.adt">adt</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            clifpy.tables.adt.Adt" href="../tables/#clifpy.tables.adt.Adt">Adt</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ADT table object</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="clifpy.clif_orchestrator.ClifOrchestrator.labs">labs</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            clifpy.tables.labs.Labs" href="../tables/#clifpy.tables.labs.Labs">Labs</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Labs table object</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="clifpy.clif_orchestrator.ClifOrchestrator.vitals">vitals</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            clifpy.tables.vitals.Vitals" href="../tables/#clifpy.tables.vitals.Vitals">Vitals</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Vitals table object</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="clifpy.clif_orchestrator.ClifOrchestrator.medication_admin_continuous">medication_admin_continuous</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            clifpy.tables.medication_admin_continuous.MedicationAdminContinuous" href="../tables/#clifpy.tables.medication_admin_continuous.MedicationAdminContinuous">MedicationAdminContinuous</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Medication administration continuous table object</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="clifpy.clif_orchestrator.ClifOrchestrator.medication_admin_intermittent">medication_admin_intermittent</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            clifpy.tables.medication_admin_intermittent.MedicationAdminIntermittent" href="../tables/#clifpy.tables.medication_admin_intermittent.MedicationAdminIntermittent">MedicationAdminIntermittent</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Medication administration intermittent table object</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="clifpy.clif_orchestrator.ClifOrchestrator.patient_assessments">patient_assessments</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            clifpy.tables.patient_assessments.PatientAssessments" href="../tables/#clifpy.tables.patient_assessments.PatientAssessments">PatientAssessments</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Patient assessments table object</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="clifpy.clif_orchestrator.ClifOrchestrator.respiratory_support">respiratory_support</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            clifpy.tables.respiratory_support.RespiratorySupport" href="../tables/#clifpy.tables.respiratory_support.RespiratorySupport">RespiratorySupport</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Respiratory support table object</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="clifpy.clif_orchestrator.ClifOrchestrator.position">position</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            clifpy.tables.position.Position" href="../tables/#clifpy.tables.position.Position">Position</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Position table object</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="clifpy.clif_orchestrator.ClifOrchestrator.hospital_diagnosis">hospital_diagnosis</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            clifpy.tables.hospital_diagnosis.HospitalDiagnosis" href="../tables/#clifpy.tables.hospital_diagnosis.HospitalDiagnosis">HospitalDiagnosis</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hospital diagnosis table object</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="clifpy.clif_orchestrator.ClifOrchestrator.microbiology_culture">microbiology_culture</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            clifpy.tables.microbiology_culture.MicrobiologyCulture" href="../tables/#clifpy.tables.microbiology_culture.MicrobiologyCulture">MicrobiologyCulture</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Microbiology culture table object</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="clifpy.clif_orchestrator.ClifOrchestrator.crrt_therapy">crrt_therapy</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            clifpy.tables.crrt_therapy.CrrtTherapy" href="../tables/#clifpy.tables.crrt_therapy.CrrtTherapy">CrrtTherapy</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>CRRT therapy table object</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="clifpy.clif_orchestrator.ClifOrchestrator.patient_procedures">patient_procedures</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            clifpy.tables.patient_procedures.PatientProcedures" href="../tables/#clifpy.tables.patient_procedures.PatientProcedures">PatientProcedures</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Patient procedures table object</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="clifpy.clif_orchestrator.ClifOrchestrator.microbiology_susceptibility">microbiology_susceptibility</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            clifpy.tables.microbiology_susceptibility.MicrobiologySusceptibility" href="../tables/#clifpy.tables.microbiology_susceptibility.MicrobiologySusceptibility">MicrobiologySusceptibility</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Microbiology susceptibility table object</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="clifpy.clif_orchestrator.ClifOrchestrator.ecmo_mcs">ecmo_mcs</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            clifpy.tables.ecmo_mcs.EcmoMcs" href="../tables/#clifpy.tables.ecmo_mcs.EcmoMcs">EcmoMcs</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ECMO/MCS table object</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="clifpy.clif_orchestrator.ClifOrchestrator.microbiology_nonculture">microbiology_nonculture</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            clifpy.tables.microbiology_nonculture.MicrobiologyNonculture" href="../tables/#clifpy.tables.microbiology_nonculture.MicrobiologyNonculture">MicrobiologyNonculture</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Microbiology non-culture table object</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="clifpy.clif_orchestrator.ClifOrchestrator.code_status">code_status</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            clifpy.tables.code_status.CodeStatus" href="../tables/#clifpy.tables.code_status.CodeStatus">CodeStatus</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Code status table object</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="clifpy.clif_orchestrator.ClifOrchestrator.wide_df">wide_df</span></code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Wide dataset with time-series data (populated by create_wide_dataset)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>Initialize the ClifOrchestrator.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to configuration JSON file</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data_directory</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the directory containing data files</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filetype</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of data file (csv, parquet, etc.)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timezone</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Timezone for datetime columns</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_directory</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory for saving output files and logs.
If not provided, creates an 'output' directory in the current working directory.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stitch_encounter</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to stitch encounters within time interval. Default False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stitch_time_interval</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hours between discharge and next admission to consider 
encounters linked. Default 6 hours.</p>
              </div>
            </td>
            <td>
                  <code>6</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>Loading priority:</p>
<ol>
<li>If all required params provided → use them</li>
<li>If config_path provided → load from that path, allow param overrides</li>
<li>If no params and no config_path → auto-detect config.json</li>
<li>Parameters override config file values when both are provided</li>
</ol>
</details>







                  <details class="quote">
                    <summary>Source code in <code>clifpy/clif_orchestrator.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="n">config_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="n">data_directory</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="n">filetype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="n">timezone</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="n">output_directory</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="n">stitch_encounter</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="n">stitch_time_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">6</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="p">):</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">    Initialize the ClifOrchestrator.</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">    config_path : str, optional</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        Path to configuration JSON file</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">    data_directory : str, optional</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">        Path to the directory containing data files</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">    filetype : str, optional</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">        Type of data file (csv, parquet, etc.)</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">    timezone : str, optional</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">        Timezone for datetime columns</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">    output_directory : str, optional</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">        Directory for saving output files and logs.</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">        If not provided, creates an &#39;output&#39; directory in the current working directory.</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">    stitch_encounter : bool, optional</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">        Whether to stitch encounters within time interval. Default False.</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">    stitch_time_interval : int, optional</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">        Hours between discharge and next admission to consider </span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">        encounters linked. Default 6 hours.</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">    Notes</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">    -----</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">    Loading priority:</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">    1. If all required params provided → use them</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">    2. If config_path provided → load from that path, allow param overrides</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">    3. If no params and no config_path → auto-detect config.json</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">    4. Parameters override config file values when both are provided</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="c1"># Get configuration from config file or parameters</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>    <span class="n">config</span> <span class="o">=</span> <span class="n">get_config_or_params</span><span class="p">(</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="n">config_path</span><span class="o">=</span><span class="n">config_path</span><span class="p">,</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>        <span class="n">data_directory</span><span class="o">=</span><span class="n">data_directory</span><span class="p">,</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="n">filetype</span><span class="o">=</span><span class="n">filetype</span><span class="p">,</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>        <span class="n">timezone</span><span class="o">=</span><span class="n">timezone</span><span class="p">,</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="n">output_directory</span><span class="o">=</span><span class="n">output_directory</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="p">)</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">data_directory</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s1">&#39;data_directory&#39;</span><span class="p">]</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s1">&#39;filetype&#39;</span><span class="p">]</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">timezone</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s1">&#39;timezone&#39;</span><span class="p">]</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="c1"># Set output directory</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">output_directory</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;output_directory&#39;</span><span class="p">)</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_directory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;output&#39;</span><span class="p">)</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_directory</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>    <span class="c1"># Initialize centralized logging</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>    <span class="n">setup_logging</span><span class="p">(</span><span class="n">output_directory</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">output_directory</span><span class="p">)</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>    <span class="c1"># Get logger for orchestrator</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;clifpy.ClifOrchestrator&#39;</span><span class="p">)</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>    <span class="c1"># Set stitching parameters</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">stitch_encounter</span> <span class="o">=</span> <span class="n">stitch_encounter</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">stitch_time_interval</span> <span class="o">=</span> <span class="n">stitch_time_interval</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">encounter_mapping</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>    <span class="c1"># Initialize all table attributes to None</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">patient</span><span class="p">:</span> <span class="n">Patient</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">hospitalization</span><span class="p">:</span> <span class="n">Hospitalization</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">adt</span><span class="p">:</span> <span class="n">Adt</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">:</span> <span class="n">Labs</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">vitals</span><span class="p">:</span> <span class="n">Vitals</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">medication_admin_continuous</span><span class="p">:</span> <span class="n">MedicationAdminContinuous</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">medication_admin_intermittent</span><span class="p">:</span> <span class="n">MedicationAdminIntermittent</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">patient_assessments</span><span class="p">:</span> <span class="n">PatientAssessments</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">respiratory_support</span><span class="p">:</span> <span class="n">RespiratorySupport</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">:</span> <span class="n">Position</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">hospital_diagnosis</span><span class="p">:</span> <span class="n">HospitalDiagnosis</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">microbiology_culture</span><span class="p">:</span> <span class="n">MicrobiologyCulture</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">crrt_therapy</span><span class="p">:</span> <span class="n">CrrtTherapy</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">patient_procedures</span><span class="p">:</span> <span class="n">PatientProcedures</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">microbiology_susceptibility</span><span class="p">:</span> <span class="n">MicrobiologySusceptibility</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ecmo_mcs</span><span class="p">:</span> <span class="n">EcmoMcs</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">microbiology_nonculture</span><span class="p">:</span> <span class="n">MicrobiologyNonculture</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">code_status</span><span class="p">:</span> <span class="n">CodeStatus</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>    <span class="c1"># Initialize wide dataset property</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">wide_df</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;ClifOrchestrator initialized&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="clifpy.clif_orchestrator.ClifOrchestrator.compute_sofa_scores" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">compute_sofa_scores</span>


<a href="#clifpy.clif_orchestrator.ClifOrchestrator.compute_sofa_scores" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">compute_sofa_scores</span><span class="p">(</span><span class="n">wide_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cohort_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">extremal_type</span><span class="o">=</span><span class="s1">&#39;worst&#39;</span><span class="p">,</span> <span class="n">id_name</span><span class="o">=</span><span class="s1">&#39;encounter_block&#39;</span><span class="p">,</span> <span class="n">fill_na_scores_with_zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_outliers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">create_new_wide_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute SOFA (Sequential Organ Failure Assessment) scores.</p>
<p>Parameters:
    wide_df: Optional wide dataset. If not provided, uses self.wide_df or creates one
    cohort_df: Optional DataFrame with columns [id_name, 'start_time', 'end_time']
              to further filter observations by time windows
    extremal_type: 'worst' (default) or 'latest' (future feature)
    id_name: Column name for grouping (default: 'encounter_block')
            - 'encounter_block': Groups related hospitalizations (requires encounter stitching)
            - 'hospitalization_id': Individual hospitalizations
    fill_na_scores_with_zero: If True, missing component scores default to 0
    remove_outliers: If True, overwrite the df of the table object associated with the orchestrator with outliers nullified
    create_new_wide_df: If True, create a new wide dataset for SOFA computation and save it at .wide_df_sofa. 
        If False, use the existing .wide_df.</p>
<p>Returns:
    DataFrame with SOFA component scores and total score for each ID.
    Results are stored in self.sofa_df.</p>
<p>Notes:
    - Medication units should be pre-converted (e.g., 'norepinephrine_mcg_kg_min')
    - When id_name='encounter_block' and encounter mapping doesn't exist,
      it will be created automatically via run_stitch_encounters()
    - Missing data defaults to score of 0 (normal organ function)</p>
<p>Examples:
    Basic usage:
    &gt;&gt;&gt; co = ClifOrchestrator(config_path='config/config.yaml')
    &gt;&gt;&gt; sofa_scores = co.compute_sofa_scores()</p>
<div class="highlight"><pre><span></span><code>Per hospitalization instead of encounter:
&gt;&gt;&gt; sofa_scores = co.compute_sofa_scores(id_name=&#39;hospitalization_id&#39;)

With time filtering:
&gt;&gt;&gt; cohort_df = pd.DataFrame({
...     &#39;encounter_block&#39;: [&#39;E001&#39;, &#39;E002&#39;],
...     &#39;start_time&#39;: pd.to_datetime([&#39;2024-01-01&#39;, &#39;2024-01-02&#39;]),
...     &#39;end_time&#39;: pd.to_datetime([&#39;2024-01-03&#39;, &#39;2024-01-04&#39;])
... })
&gt;&gt;&gt; sofa_scores = co.compute_sofa_scores(cohort_df=cohort_df)
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>clifpy/clif_orchestrator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span>
<span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span>
<span class="normal"><a href="#__codelineno-0-1208">1208</a></span>
<span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span>
<span class="normal"><a href="#__codelineno-0-1213">1213</a></span>
<span class="normal"><a href="#__codelineno-0-1214">1214</a></span>
<span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span>
<span class="normal"><a href="#__codelineno-0-1225">1225</a></span>
<span class="normal"><a href="#__codelineno-0-1226">1226</a></span>
<span class="normal"><a href="#__codelineno-0-1227">1227</a></span>
<span class="normal"><a href="#__codelineno-0-1228">1228</a></span>
<span class="normal"><a href="#__codelineno-0-1229">1229</a></span>
<span class="normal"><a href="#__codelineno-0-1230">1230</a></span>
<span class="normal"><a href="#__codelineno-0-1231">1231</a></span>
<span class="normal"><a href="#__codelineno-0-1232">1232</a></span>
<span class="normal"><a href="#__codelineno-0-1233">1233</a></span>
<span class="normal"><a href="#__codelineno-0-1234">1234</a></span>
<span class="normal"><a href="#__codelineno-0-1235">1235</a></span>
<span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span>
<span class="normal"><a href="#__codelineno-0-1242">1242</a></span>
<span class="normal"><a href="#__codelineno-0-1243">1243</a></span>
<span class="normal"><a href="#__codelineno-0-1244">1244</a></span>
<span class="normal"><a href="#__codelineno-0-1245">1245</a></span>
<span class="normal"><a href="#__codelineno-0-1246">1246</a></span>
<span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span>
<span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span>
<span class="normal"><a href="#__codelineno-0-1259">1259</a></span>
<span class="normal"><a href="#__codelineno-0-1260">1260</a></span>
<span class="normal"><a href="#__codelineno-0-1261">1261</a></span>
<span class="normal"><a href="#__codelineno-0-1262">1262</a></span>
<span class="normal"><a href="#__codelineno-0-1263">1263</a></span>
<span class="normal"><a href="#__codelineno-0-1264">1264</a></span>
<span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span>
<span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span>
<span class="normal"><a href="#__codelineno-0-1279">1279</a></span>
<span class="normal"><a href="#__codelineno-0-1280">1280</a></span>
<span class="normal"><a href="#__codelineno-0-1281">1281</a></span>
<span class="normal"><a href="#__codelineno-0-1282">1282</a></span>
<span class="normal"><a href="#__codelineno-0-1283">1283</a></span>
<span class="normal"><a href="#__codelineno-0-1284">1284</a></span>
<span class="normal"><a href="#__codelineno-0-1285">1285</a></span>
<span class="normal"><a href="#__codelineno-0-1286">1286</a></span>
<span class="normal"><a href="#__codelineno-0-1287">1287</a></span>
<span class="normal"><a href="#__codelineno-0-1288">1288</a></span>
<span class="normal"><a href="#__codelineno-0-1289">1289</a></span>
<span class="normal"><a href="#__codelineno-0-1290">1290</a></span>
<span class="normal"><a href="#__codelineno-0-1291">1291</a></span>
<span class="normal"><a href="#__codelineno-0-1292">1292</a></span>
<span class="normal"><a href="#__codelineno-0-1293">1293</a></span>
<span class="normal"><a href="#__codelineno-0-1294">1294</a></span>
<span class="normal"><a href="#__codelineno-0-1295">1295</a></span>
<span class="normal"><a href="#__codelineno-0-1296">1296</a></span>
<span class="normal"><a href="#__codelineno-0-1297">1297</a></span>
<span class="normal"><a href="#__codelineno-0-1298">1298</a></span>
<span class="normal"><a href="#__codelineno-0-1299">1299</a></span>
<span class="normal"><a href="#__codelineno-0-1300">1300</a></span>
<span class="normal"><a href="#__codelineno-0-1301">1301</a></span>
<span class="normal"><a href="#__codelineno-0-1302">1302</a></span>
<span class="normal"><a href="#__codelineno-0-1303">1303</a></span>
<span class="normal"><a href="#__codelineno-0-1304">1304</a></span>
<span class="normal"><a href="#__codelineno-0-1305">1305</a></span>
<span class="normal"><a href="#__codelineno-0-1306">1306</a></span>
<span class="normal"><a href="#__codelineno-0-1307">1307</a></span>
<span class="normal"><a href="#__codelineno-0-1308">1308</a></span>
<span class="normal"><a href="#__codelineno-0-1309">1309</a></span>
<span class="normal"><a href="#__codelineno-0-1310">1310</a></span>
<span class="normal"><a href="#__codelineno-0-1311">1311</a></span>
<span class="normal"><a href="#__codelineno-0-1312">1312</a></span>
<span class="normal"><a href="#__codelineno-0-1313">1313</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1198" name="__codelineno-0-1198"></a><span class="k">def</span><span class="w"> </span><span class="nf">compute_sofa_scores</span><span class="p">(</span>
<a id="__codelineno-0-1199" name="__codelineno-0-1199"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1200" name="__codelineno-0-1200"></a>    <span class="n">wide_df</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1201" name="__codelineno-0-1201"></a>    <span class="n">cohort_df</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1202" name="__codelineno-0-1202"></a>    <span class="n">extremal_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;worst&#39;</span><span class="p">,</span>
<a id="__codelineno-0-1203" name="__codelineno-0-1203"></a>    <span class="n">id_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;encounter_block&#39;</span><span class="p">,</span>
<a id="__codelineno-0-1204" name="__codelineno-0-1204"></a>    <span class="n">fill_na_scores_with_zero</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1205" name="__codelineno-0-1205"></a>    <span class="n">remove_outliers</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1206" name="__codelineno-0-1206"></a>    <span class="n">create_new_wide_df</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1207" name="__codelineno-0-1207"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-1208" name="__codelineno-0-1208"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1209" name="__codelineno-0-1209"></a><span class="sd">    Compute SOFA (Sequential Organ Failure Assessment) scores.</span>
<a id="__codelineno-0-1210" name="__codelineno-0-1210"></a>
<a id="__codelineno-0-1211" name="__codelineno-0-1211"></a><span class="sd">    Parameters:</span>
<a id="__codelineno-0-1212" name="__codelineno-0-1212"></a><span class="sd">        wide_df: Optional wide dataset. If not provided, uses self.wide_df or creates one</span>
<a id="__codelineno-0-1213" name="__codelineno-0-1213"></a><span class="sd">        cohort_df: Optional DataFrame with columns [id_name, &#39;start_time&#39;, &#39;end_time&#39;]</span>
<a id="__codelineno-0-1214" name="__codelineno-0-1214"></a><span class="sd">                  to further filter observations by time windows</span>
<a id="__codelineno-0-1215" name="__codelineno-0-1215"></a><span class="sd">        extremal_type: &#39;worst&#39; (default) or &#39;latest&#39; (future feature)</span>
<a id="__codelineno-0-1216" name="__codelineno-0-1216"></a><span class="sd">        id_name: Column name for grouping (default: &#39;encounter_block&#39;)</span>
<a id="__codelineno-0-1217" name="__codelineno-0-1217"></a><span class="sd">                - &#39;encounter_block&#39;: Groups related hospitalizations (requires encounter stitching)</span>
<a id="__codelineno-0-1218" name="__codelineno-0-1218"></a><span class="sd">                - &#39;hospitalization_id&#39;: Individual hospitalizations</span>
<a id="__codelineno-0-1219" name="__codelineno-0-1219"></a><span class="sd">        fill_na_scores_with_zero: If True, missing component scores default to 0</span>
<a id="__codelineno-0-1220" name="__codelineno-0-1220"></a><span class="sd">        remove_outliers: If True, overwrite the df of the table object associated with the orchestrator with outliers nullified</span>
<a id="__codelineno-0-1221" name="__codelineno-0-1221"></a><span class="sd">        create_new_wide_df: If True, create a new wide dataset for SOFA computation and save it at .wide_df_sofa. </span>
<a id="__codelineno-0-1222" name="__codelineno-0-1222"></a><span class="sd">            If False, use the existing .wide_df.</span>
<a id="__codelineno-0-1223" name="__codelineno-0-1223"></a>
<a id="__codelineno-0-1224" name="__codelineno-0-1224"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1225" name="__codelineno-0-1225"></a><span class="sd">        DataFrame with SOFA component scores and total score for each ID.</span>
<a id="__codelineno-0-1226" name="__codelineno-0-1226"></a><span class="sd">        Results are stored in self.sofa_df.</span>
<a id="__codelineno-0-1227" name="__codelineno-0-1227"></a>
<a id="__codelineno-0-1228" name="__codelineno-0-1228"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-1229" name="__codelineno-0-1229"></a><span class="sd">        - Medication units should be pre-converted (e.g., &#39;norepinephrine_mcg_kg_min&#39;)</span>
<a id="__codelineno-0-1230" name="__codelineno-0-1230"></a><span class="sd">        - When id_name=&#39;encounter_block&#39; and encounter mapping doesn&#39;t exist,</span>
<a id="__codelineno-0-1231" name="__codelineno-0-1231"></a><span class="sd">          it will be created automatically via run_stitch_encounters()</span>
<a id="__codelineno-0-1232" name="__codelineno-0-1232"></a><span class="sd">        - Missing data defaults to score of 0 (normal organ function)</span>
<a id="__codelineno-0-1233" name="__codelineno-0-1233"></a>
<a id="__codelineno-0-1234" name="__codelineno-0-1234"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-1235" name="__codelineno-0-1235"></a><span class="sd">        Basic usage:</span>
<a id="__codelineno-0-1236" name="__codelineno-0-1236"></a><span class="sd">        &gt;&gt;&gt; co = ClifOrchestrator(config_path=&#39;config/config.yaml&#39;)</span>
<a id="__codelineno-0-1237" name="__codelineno-0-1237"></a><span class="sd">        &gt;&gt;&gt; sofa_scores = co.compute_sofa_scores()</span>
<a id="__codelineno-0-1238" name="__codelineno-0-1238"></a>
<a id="__codelineno-0-1239" name="__codelineno-0-1239"></a><span class="sd">        Per hospitalization instead of encounter:</span>
<a id="__codelineno-0-1240" name="__codelineno-0-1240"></a><span class="sd">        &gt;&gt;&gt; sofa_scores = co.compute_sofa_scores(id_name=&#39;hospitalization_id&#39;)</span>
<a id="__codelineno-0-1241" name="__codelineno-0-1241"></a>
<a id="__codelineno-0-1242" name="__codelineno-0-1242"></a><span class="sd">        With time filtering:</span>
<a id="__codelineno-0-1243" name="__codelineno-0-1243"></a><span class="sd">        &gt;&gt;&gt; cohort_df = pd.DataFrame({</span>
<a id="__codelineno-0-1244" name="__codelineno-0-1244"></a><span class="sd">        ...     &#39;encounter_block&#39;: [&#39;E001&#39;, &#39;E002&#39;],</span>
<a id="__codelineno-0-1245" name="__codelineno-0-1245"></a><span class="sd">        ...     &#39;start_time&#39;: pd.to_datetime([&#39;2024-01-01&#39;, &#39;2024-01-02&#39;]),</span>
<a id="__codelineno-0-1246" name="__codelineno-0-1246"></a><span class="sd">        ...     &#39;end_time&#39;: pd.to_datetime([&#39;2024-01-03&#39;, &#39;2024-01-04&#39;])</span>
<a id="__codelineno-0-1247" name="__codelineno-0-1247"></a><span class="sd">        ... })</span>
<a id="__codelineno-0-1248" name="__codelineno-0-1248"></a><span class="sd">        &gt;&gt;&gt; sofa_scores = co.compute_sofa_scores(cohort_df=cohort_df)</span>
<a id="__codelineno-0-1249" name="__codelineno-0-1249"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1250" name="__codelineno-0-1250"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">.utils.sofa</span><span class="w"> </span><span class="kn">import</span> <span class="n">compute_sofa</span><span class="p">,</span> <span class="n">REQUIRED_SOFA_CATEGORIES_BY_TABLE</span>
<a id="__codelineno-0-1251" name="__codelineno-0-1251"></a>
<a id="__codelineno-0-1252" name="__codelineno-0-1252"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Computing SOFA scores with extremal_type=&#39;</span><span class="si">{</span><span class="n">extremal_type</span><span class="si">}</span><span class="s2">&#39;, id_name=&#39;</span><span class="si">{</span><span class="n">id_name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1253" name="__codelineno-0-1253"></a>
<a id="__codelineno-0-1254" name="__codelineno-0-1254"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">cohort_df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">id_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cohort_df</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
<a id="__codelineno-0-1255" name="__codelineno-0-1255"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;id_name &#39;</span><span class="si">{</span><span class="n">id_name</span><span class="si">}</span><span class="s2">&#39; not found in cohort_df columns&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1256" name="__codelineno-0-1256"></a>
<a id="__codelineno-0-1257" name="__codelineno-0-1257"></a>    <span class="c1"># Determine which wide_df to use</span>
<a id="__codelineno-0-1258" name="__codelineno-0-1258"></a>    <span class="k">if</span> <span class="n">wide_df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1259" name="__codelineno-0-1259"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Using provided wide_df&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1260" name="__codelineno-0-1260"></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">wide_df</span>
<a id="__codelineno-0-1261" name="__codelineno-0-1261"></a>    <span class="k">elif</span> <span class="n">create_new_wide_df</span><span class="p">:</span>
<a id="__codelineno-0-1262" name="__codelineno-0-1262"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Ignoring any existing .wide_df and creating a new wide dataset for SOFA computation&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1263" name="__codelineno-0-1263"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_wide_dataset</span><span class="p">(</span>
<a id="__codelineno-0-1264" name="__codelineno-0-1264"></a>            <span class="n">tables_to_load</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">REQUIRED_SOFA_CATEGORIES_BY_TABLE</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
<a id="__codelineno-0-1265" name="__codelineno-0-1265"></a>            <span class="n">category_filters</span><span class="o">=</span><span class="n">REQUIRED_SOFA_CATEGORIES_BY_TABLE</span><span class="p">,</span>
<a id="__codelineno-0-1266" name="__codelineno-0-1266"></a>            <span class="n">cohort_df</span><span class="o">=</span><span class="n">cohort_df</span><span class="p">,</span>
<a id="__codelineno-0-1267" name="__codelineno-0-1267"></a>            <span class="n">return_dataframe</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-1268" name="__codelineno-0-1268"></a>        <span class="p">)</span>
<a id="__codelineno-0-1269" name="__codelineno-0-1269"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wide_df</span> <span class="k">if</span> <span class="n">df</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">df</span>
<a id="__codelineno-0-1270" name="__codelineno-0-1270"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">wide_df_sofa</span> <span class="o">=</span> <span class="n">df</span>
<a id="__codelineno-0-1271" name="__codelineno-0-1271"></a>    <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;wide_df&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">wide_df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1272" name="__codelineno-0-1272"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Using existing self.wide_df&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1273" name="__codelineno-0-1273"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wide_df</span>
<a id="__codelineno-0-1274" name="__codelineno-0-1274"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1275" name="__codelineno-0-1275"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;No wide dataset available, creating one...&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1276" name="__codelineno-0-1276"></a>        <span class="c1"># Create wide dataset with required categories for SOFA</span>
<a id="__codelineno-0-1277" name="__codelineno-0-1277"></a>
<a id="__codelineno-0-1278" name="__codelineno-0-1278"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">create_wide_dataset</span><span class="p">(</span>
<a id="__codelineno-0-1279" name="__codelineno-0-1279"></a>            <span class="n">tables_to_load</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">REQUIRED_SOFA_CATEGORIES_BY_TABLE</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
<a id="__codelineno-0-1280" name="__codelineno-0-1280"></a>            <span class="n">category_filters</span><span class="o">=</span><span class="n">REQUIRED_SOFA_CATEGORIES_BY_TABLE</span><span class="p">,</span>
<a id="__codelineno-0-1281" name="__codelineno-0-1281"></a>            <span class="n">cohort_df</span><span class="o">=</span><span class="n">cohort_df</span>
<a id="__codelineno-0-1282" name="__codelineno-0-1282"></a>        <span class="p">)</span>
<a id="__codelineno-0-1283" name="__codelineno-0-1283"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wide_df</span>
<a id="__codelineno-0-1284" name="__codelineno-0-1284"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Created wide dataset with shape: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1285" name="__codelineno-0-1285"></a>
<a id="__codelineno-0-1286" name="__codelineno-0-1286"></a>    <span class="k">if</span> <span class="n">id_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
<a id="__codelineno-0-1287" name="__codelineno-0-1287"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">encounter_mapping</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1288" name="__codelineno-0-1288"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Encounter mapping not found, running stitch_encounters()&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1289" name="__codelineno-0-1289"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-1290" name="__codelineno-0-1290"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">run_stitch_encounters</span><span class="p">()</span>
<a id="__codelineno-0-1291" name="__codelineno-0-1291"></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-1292" name="__codelineno-0-1292"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error during encounter stitching: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1293" name="__codelineno-0-1293"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Encounter stitching failed. Please run stitch_encounters() manually.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1294" name="__codelineno-0-1294"></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encounter_mapping</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;hospitalization_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<a id="__codelineno-0-1295" name="__codelineno-0-1295"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">wide_df</span> <span class="o">=</span> <span class="n">df</span>
<a id="__codelineno-0-1296" name="__codelineno-0-1296"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mapped </span><span class="si">{</span><span class="n">id_name</span><span class="si">}</span><span class="s2"> to wide_df via encounter_mapping, with shape: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1297" name="__codelineno-0-1297"></a>
<a id="__codelineno-0-1298" name="__codelineno-0-1298"></a>    <span class="c1"># Compute SOFA scores</span>
<a id="__codelineno-0-1299" name="__codelineno-0-1299"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Calling compute_sofa function&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1300" name="__codelineno-0-1300"></a>    <span class="n">sofa_scores</span> <span class="o">=</span> <span class="n">compute_sofa</span><span class="p">(</span>
<a id="__codelineno-0-1301" name="__codelineno-0-1301"></a>        <span class="n">wide_df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
<a id="__codelineno-0-1302" name="__codelineno-0-1302"></a>        <span class="n">cohort_df</span><span class="o">=</span><span class="n">cohort_df</span><span class="p">,</span>
<a id="__codelineno-0-1303" name="__codelineno-0-1303"></a>        <span class="n">extremal_type</span><span class="o">=</span><span class="n">extremal_type</span><span class="p">,</span>
<a id="__codelineno-0-1304" name="__codelineno-0-1304"></a>        <span class="n">id_name</span><span class="o">=</span><span class="n">id_name</span><span class="p">,</span>
<a id="__codelineno-0-1305" name="__codelineno-0-1305"></a>        <span class="n">fill_na_scores_with_zero</span><span class="o">=</span><span class="n">fill_na_scores_with_zero</span><span class="p">,</span>
<a id="__codelineno-0-1306" name="__codelineno-0-1306"></a>        <span class="n">remove_outliers</span><span class="o">=</span><span class="n">remove_outliers</span>
<a id="__codelineno-0-1307" name="__codelineno-0-1307"></a>    <span class="p">)</span>
<a id="__codelineno-0-1308" name="__codelineno-0-1308"></a>
<a id="__codelineno-0-1309" name="__codelineno-0-1309"></a>    <span class="c1"># Store results in orchestrator</span>
<a id="__codelineno-0-1310" name="__codelineno-0-1310"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">sofa_df</span> <span class="o">=</span> <span class="n">sofa_scores</span>
<a id="__codelineno-0-1311" name="__codelineno-0-1311"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SOFA computation completed. Results stored in self.sofa_df with shape: </span><span class="si">{</span><span class="n">sofa_scores</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1312" name="__codelineno-0-1312"></a>
<a id="__codelineno-0-1313" name="__codelineno-0-1313"></a>    <span class="k">return</span> <span class="n">sofa_scores</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="clifpy.clif_orchestrator.ClifOrchestrator.convert_dose_units_for_continuous_meds" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">convert_dose_units_for_continuous_meds</span>


<a href="#clifpy.clif_orchestrator.ClifOrchestrator.convert_dose_units_for_continuous_meds" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">convert_dose_units_for_continuous_meds</span><span class="p">(</span><span class="n">preferred_units</span><span class="p">,</span> <span class="n">vitals_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show_intermediate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save_to_table</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert dose units for continuous medication data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>preferred_units</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict of preferred units for each medication category</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>vitals_df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Vitals DataFrame for extracting patient weights</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_intermediate</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, includes intermediate calculation columns in output</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>override</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, continues processing with warnings for unacceptable units</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>save_to_table</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, saves the converted DataFrame to the table's df_converted
property and stores conversion_counts as a table property. If False,
returns the converted data without updating the table.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="pandas.DataFrame">DataFrame</span>, <span title="pandas.DataFrame">DataFrame</span>] or None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(converted_df, counts_df) when save_to_table=False, None otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>clifpy/clif_orchestrator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span>
<span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1038" name="__codelineno-0-1038"></a><span class="k">def</span><span class="w"> </span><span class="nf">convert_dose_units_for_continuous_meds</span><span class="p">(</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a>    <span class="n">preferred_units</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a>    <span class="n">vitals_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a>    <span class="n">show_intermediate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a>    <span class="n">override</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a>    <span class="n">save_to_table</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]:</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a><span class="sd">    Convert dose units for continuous medication data.</span>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a>
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a><span class="sd">    preferred_units : Dict[str, str]</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a><span class="sd">        Dict of preferred units for each medication category</span>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a><span class="sd">    vitals_df : pd.DataFrame, optional</span>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a><span class="sd">        Vitals DataFrame for extracting patient weights</span>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a><span class="sd">    show_intermediate : bool, default=False</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a><span class="sd">        If True, includes intermediate calculation columns in output</span>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a><span class="sd">    override : bool, default=False</span>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a><span class="sd">        If True, continues processing with warnings for unacceptable units</span>
<a id="__codelineno-0-1059" name="__codelineno-0-1059"></a><span class="sd">    save_to_table : bool, default=True</span>
<a id="__codelineno-0-1060" name="__codelineno-0-1060"></a><span class="sd">        If True, saves the converted DataFrame to the table&#39;s df_converted</span>
<a id="__codelineno-0-1061" name="__codelineno-0-1061"></a><span class="sd">        property and stores conversion_counts as a table property. If False,</span>
<a id="__codelineno-0-1062" name="__codelineno-0-1062"></a><span class="sd">        returns the converted data without updating the table.</span>
<a id="__codelineno-0-1063" name="__codelineno-0-1063"></a>
<a id="__codelineno-0-1064" name="__codelineno-0-1064"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-1065" name="__codelineno-0-1065"></a><span class="sd">    -------</span>
<a id="__codelineno-0-1066" name="__codelineno-0-1066"></a><span class="sd">    Tuple[pd.DataFrame, pd.DataFrame] or None</span>
<a id="__codelineno-0-1067" name="__codelineno-0-1067"></a><span class="sd">        (converted_df, counts_df) when save_to_table=False, None otherwise</span>
<a id="__codelineno-0-1068" name="__codelineno-0-1068"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1069" name="__codelineno-0-1069"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">.utils.unit_converter</span><span class="w"> </span><span class="kn">import</span> <span class="n">convert_dose_units_by_med_category</span>
<a id="__codelineno-0-1070" name="__codelineno-0-1070"></a>
<a id="__codelineno-0-1071" name="__codelineno-0-1071"></a>    <span class="c1"># Log function entry with parameters</span>
<a id="__codelineno-0-1072" name="__codelineno-0-1072"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting dose unit conversion for continuous medications with parameters: &quot;</span>
<a id="__codelineno-0-1073" name="__codelineno-0-1073"></a>                    <span class="sa">f</span><span class="s2">&quot;preferred_units=</span><span class="si">{</span><span class="n">preferred_units</span><span class="si">}</span><span class="s2">, show_intermediate=</span><span class="si">{</span><span class="n">show_intermediate</span><span class="si">}</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-1074" name="__codelineno-0-1074"></a>                    <span class="sa">f</span><span class="s2">&quot;override=</span><span class="si">{</span><span class="n">override</span><span class="si">}</span><span class="s2">, overwrite_table_df=</span><span class="si">{</span><span class="n">save_to_table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1075" name="__codelineno-0-1075"></a>
<a id="__codelineno-0-1076" name="__codelineno-0-1076"></a>    <span class="c1"># use the vitals df loaded to the table instance if no stand-alone vitals_df is provided</span>
<a id="__codelineno-0-1077" name="__codelineno-0-1077"></a>    <span class="k">if</span> <span class="n">vitals_df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1078" name="__codelineno-0-1078"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;No vitals_df provided, checking existing vitals table&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1079" name="__codelineno-0-1079"></a>        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vitals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vitals</span><span class="o">.</span><span class="n">df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-1080" name="__codelineno-0-1080"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading vitals table...&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1081" name="__codelineno-0-1081"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">load_table</span><span class="p">(</span><span class="s1">&#39;vitals&#39;</span><span class="p">)</span>
<a id="__codelineno-0-1082" name="__codelineno-0-1082"></a>        <span class="n">vitals_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vitals</span><span class="o">.</span><span class="n">df</span>
<a id="__codelineno-0-1083" name="__codelineno-0-1083"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using vitals data with shape: </span><span class="si">{</span><span class="n">vitals_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1084" name="__codelineno-0-1084"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1085" name="__codelineno-0-1085"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using provided vitals_df with shape: </span><span class="si">{</span><span class="n">vitals_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1086" name="__codelineno-0-1086"></a>
<a id="__codelineno-0-1087" name="__codelineno-0-1087"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">medication_admin_continuous</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1088" name="__codelineno-0-1088"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading medication_admin_continuous table...&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1089" name="__codelineno-0-1089"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">load_table</span><span class="p">(</span><span class="s1">&#39;medication_admin_continuous&#39;</span><span class="p">)</span>
<a id="__codelineno-0-1090" name="__codelineno-0-1090"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;medication_admin_continuous table loaded successfully&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1091" name="__codelineno-0-1091"></a>
<a id="__codelineno-0-1092" name="__codelineno-0-1092"></a>    <span class="c1"># Call the conversion function with all parameters</span>
<a id="__codelineno-0-1093" name="__codelineno-0-1093"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting dose unit conversion&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1094" name="__codelineno-0-1094"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input DataFrame shape: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">medication_admin_continuous</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1095" name="__codelineno-0-1095"></a>
<a id="__codelineno-0-1096" name="__codelineno-0-1096"></a>    <span class="n">converted_df</span><span class="p">,</span> <span class="n">counts_df</span> <span class="o">=</span> <span class="n">convert_dose_units_by_med_category</span><span class="p">(</span>
<a id="__codelineno-0-1097" name="__codelineno-0-1097"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">medication_admin_continuous</span><span class="o">.</span><span class="n">df</span><span class="p">,</span>
<a id="__codelineno-0-1098" name="__codelineno-0-1098"></a>        <span class="n">vitals_df</span><span class="o">=</span><span class="n">vitals_df</span><span class="p">,</span>
<a id="__codelineno-0-1099" name="__codelineno-0-1099"></a>        <span class="n">preferred_units</span><span class="o">=</span><span class="n">preferred_units</span><span class="p">,</span>
<a id="__codelineno-0-1100" name="__codelineno-0-1100"></a>        <span class="n">show_intermediate</span><span class="o">=</span><span class="n">show_intermediate</span><span class="p">,</span>
<a id="__codelineno-0-1101" name="__codelineno-0-1101"></a>        <span class="n">override</span><span class="o">=</span><span class="n">override</span>
<a id="__codelineno-0-1102" name="__codelineno-0-1102"></a>    <span class="p">)</span>
<a id="__codelineno-0-1103" name="__codelineno-0-1103"></a>
<a id="__codelineno-0-1104" name="__codelineno-0-1104"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Dose unit conversion completed&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1105" name="__codelineno-0-1105"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Output DataFrame shape: </span><span class="si">{</span><span class="n">converted_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1106" name="__codelineno-0-1106"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Conversion counts summary: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">counts_df</span><span class="p">)</span><span class="si">}</span><span class="s2"> conversions tracked&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1107" name="__codelineno-0-1107"></a>
<a id="__codelineno-0-1108" name="__codelineno-0-1108"></a>    <span class="c1"># If overwrite_raw_df is True, update the table&#39;s df and store conversion_counts</span>
<a id="__codelineno-0-1109" name="__codelineno-0-1109"></a>    <span class="k">if</span> <span class="n">save_to_table</span><span class="p">:</span>
<a id="__codelineno-0-1110" name="__codelineno-0-1110"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Updating medication_admin_continuous table with converted data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1111" name="__codelineno-0-1111"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">medication_admin_continuous</span><span class="o">.</span><span class="n">df_converted</span> <span class="o">=</span> <span class="n">converted_df</span>
<a id="__codelineno-0-1112" name="__codelineno-0-1112"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">medication_admin_continuous</span><span class="o">.</span><span class="n">conversion_counts</span> <span class="o">=</span> <span class="n">counts_df</span>
<a id="__codelineno-0-1113" name="__codelineno-0-1113"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Conversion counts stored as table property&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1114" name="__codelineno-0-1114"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1115" name="__codelineno-0-1115"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Returning converted data without updating table&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1116" name="__codelineno-0-1116"></a>        <span class="k">return</span> <span class="n">converted_df</span><span class="p">,</span> <span class="n">counts_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="clifpy.clif_orchestrator.ClifOrchestrator.convert_dose_units_for_intermittent_meds" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">convert_dose_units_for_intermittent_meds</span>


<a href="#clifpy.clif_orchestrator.ClifOrchestrator.convert_dose_units_for_intermittent_meds" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">convert_dose_units_for_intermittent_meds</span><span class="p">(</span><span class="n">preferred_units</span><span class="p">,</span> <span class="n">vitals_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show_intermediate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save_to_table</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert dose units for intermittent medication data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>preferred_units</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict of preferred units for each medication category</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>vitals_df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Vitals DataFrame for extracting patient weights</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_intermediate</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, includes intermediate calculation columns in output</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>override</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, continues processing with warnings for unacceptable units</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>save_to_table</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, saves the converted DataFrame to the table's df_converted
property and stores conversion_counts as a table property. If False,
returns the converted data without updating the table.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="pandas.DataFrame">DataFrame</span>, <span title="pandas.DataFrame">DataFrame</span>] or None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(converted_df, counts_df) when save_to_table=False, None otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>clifpy/clif_orchestrator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span>
<span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span>
<span class="normal"><a href="#__codelineno-0-1148">1148</a></span>
<span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span>
<span class="normal"><a href="#__codelineno-0-1168">1168</a></span>
<span class="normal"><a href="#__codelineno-0-1169">1169</a></span>
<span class="normal"><a href="#__codelineno-0-1170">1170</a></span>
<span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span>
<span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span>
<span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span>
<span class="normal"><a href="#__codelineno-0-1186">1186</a></span>
<span class="normal"><a href="#__codelineno-0-1187">1187</a></span>
<span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span>
<span class="normal"><a href="#__codelineno-0-1190">1190</a></span>
<span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1118" name="__codelineno-0-1118"></a><span class="k">def</span><span class="w"> </span><span class="nf">convert_dose_units_for_intermittent_meds</span><span class="p">(</span>
<a id="__codelineno-0-1119" name="__codelineno-0-1119"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1120" name="__codelineno-0-1120"></a>    <span class="n">preferred_units</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-1121" name="__codelineno-0-1121"></a>    <span class="n">vitals_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1122" name="__codelineno-0-1122"></a>    <span class="n">show_intermediate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1123" name="__codelineno-0-1123"></a>    <span class="n">override</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1124" name="__codelineno-0-1124"></a>    <span class="n">save_to_table</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1125" name="__codelineno-0-1125"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]:</span>
<a id="__codelineno-0-1126" name="__codelineno-0-1126"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1127" name="__codelineno-0-1127"></a><span class="sd">    Convert dose units for intermittent medication data.</span>
<a id="__codelineno-0-1128" name="__codelineno-0-1128"></a>
<a id="__codelineno-0-1129" name="__codelineno-0-1129"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-1130" name="__codelineno-0-1130"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-1131" name="__codelineno-0-1131"></a><span class="sd">    preferred_units : Dict[str, str]</span>
<a id="__codelineno-0-1132" name="__codelineno-0-1132"></a><span class="sd">        Dict of preferred units for each medication category</span>
<a id="__codelineno-0-1133" name="__codelineno-0-1133"></a><span class="sd">    vitals_df : pd.DataFrame, optional</span>
<a id="__codelineno-0-1134" name="__codelineno-0-1134"></a><span class="sd">        Vitals DataFrame for extracting patient weights</span>
<a id="__codelineno-0-1135" name="__codelineno-0-1135"></a><span class="sd">    show_intermediate : bool, default=False</span>
<a id="__codelineno-0-1136" name="__codelineno-0-1136"></a><span class="sd">        If True, includes intermediate calculation columns in output</span>
<a id="__codelineno-0-1137" name="__codelineno-0-1137"></a><span class="sd">    override : bool, default=False</span>
<a id="__codelineno-0-1138" name="__codelineno-0-1138"></a><span class="sd">        If True, continues processing with warnings for unacceptable units</span>
<a id="__codelineno-0-1139" name="__codelineno-0-1139"></a><span class="sd">    save_to_table : bool, default=True</span>
<a id="__codelineno-0-1140" name="__codelineno-0-1140"></a><span class="sd">        If True, saves the converted DataFrame to the table&#39;s df_converted</span>
<a id="__codelineno-0-1141" name="__codelineno-0-1141"></a><span class="sd">        property and stores conversion_counts as a table property. If False,</span>
<a id="__codelineno-0-1142" name="__codelineno-0-1142"></a><span class="sd">        returns the converted data without updating the table.</span>
<a id="__codelineno-0-1143" name="__codelineno-0-1143"></a>
<a id="__codelineno-0-1144" name="__codelineno-0-1144"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-1145" name="__codelineno-0-1145"></a><span class="sd">    -------</span>
<a id="__codelineno-0-1146" name="__codelineno-0-1146"></a><span class="sd">    Tuple[pd.DataFrame, pd.DataFrame] or None</span>
<a id="__codelineno-0-1147" name="__codelineno-0-1147"></a><span class="sd">        (converted_df, counts_df) when save_to_table=False, None otherwise</span>
<a id="__codelineno-0-1148" name="__codelineno-0-1148"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1149" name="__codelineno-0-1149"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">.utils.unit_converter</span><span class="w"> </span><span class="kn">import</span> <span class="n">convert_dose_units_by_med_category</span>
<a id="__codelineno-0-1150" name="__codelineno-0-1150"></a>
<a id="__codelineno-0-1151" name="__codelineno-0-1151"></a>    <span class="c1"># Log function entry with parameters</span>
<a id="__codelineno-0-1152" name="__codelineno-0-1152"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting dose unit conversion for intermittent medications with parameters: &quot;</span>
<a id="__codelineno-0-1153" name="__codelineno-0-1153"></a>                    <span class="sa">f</span><span class="s2">&quot;preferred_units=</span><span class="si">{</span><span class="n">preferred_units</span><span class="si">}</span><span class="s2">, show_intermediate=</span><span class="si">{</span><span class="n">show_intermediate</span><span class="si">}</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-1154" name="__codelineno-0-1154"></a>                    <span class="sa">f</span><span class="s2">&quot;override=</span><span class="si">{</span><span class="n">override</span><span class="si">}</span><span class="s2">, save_to_table=</span><span class="si">{</span><span class="n">save_to_table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1155" name="__codelineno-0-1155"></a>
<a id="__codelineno-0-1156" name="__codelineno-0-1156"></a>    <span class="c1"># use the vitals df loaded to the table instance if no stand-alone vitals_df is provided</span>
<a id="__codelineno-0-1157" name="__codelineno-0-1157"></a>    <span class="k">if</span> <span class="n">vitals_df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1158" name="__codelineno-0-1158"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;No vitals_df provided, checking existing vitals table&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1159" name="__codelineno-0-1159"></a>        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vitals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vitals</span><span class="o">.</span><span class="n">df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-1160" name="__codelineno-0-1160"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading vitals table...&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1161" name="__codelineno-0-1161"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">load_table</span><span class="p">(</span><span class="s1">&#39;vitals&#39;</span><span class="p">)</span>
<a id="__codelineno-0-1162" name="__codelineno-0-1162"></a>        <span class="n">vitals_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vitals</span><span class="o">.</span><span class="n">df</span>
<a id="__codelineno-0-1163" name="__codelineno-0-1163"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using vitals data with shape: </span><span class="si">{</span><span class="n">vitals_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1164" name="__codelineno-0-1164"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1165" name="__codelineno-0-1165"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using provided vitals_df with shape: </span><span class="si">{</span><span class="n">vitals_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1166" name="__codelineno-0-1166"></a>
<a id="__codelineno-0-1167" name="__codelineno-0-1167"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">medication_admin_intermittent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1168" name="__codelineno-0-1168"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading medication_admin_intermittent table...&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1169" name="__codelineno-0-1169"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">load_table</span><span class="p">(</span><span class="s1">&#39;medication_admin_intermittent&#39;</span><span class="p">)</span>
<a id="__codelineno-0-1170" name="__codelineno-0-1170"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;medication_admin_intermittent table loaded successfully&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1171" name="__codelineno-0-1171"></a>
<a id="__codelineno-0-1172" name="__codelineno-0-1172"></a>    <span class="c1"># Call the conversion function with all parameters</span>
<a id="__codelineno-0-1173" name="__codelineno-0-1173"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting dose unit conversion&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1174" name="__codelineno-0-1174"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input DataFrame shape: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">medication_admin_intermittent</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1175" name="__codelineno-0-1175"></a>
<a id="__codelineno-0-1176" name="__codelineno-0-1176"></a>    <span class="n">converted_df</span><span class="p">,</span> <span class="n">counts_df</span> <span class="o">=</span> <span class="n">convert_dose_units_by_med_category</span><span class="p">(</span>
<a id="__codelineno-0-1177" name="__codelineno-0-1177"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">medication_admin_intermittent</span><span class="o">.</span><span class="n">df</span><span class="p">,</span>
<a id="__codelineno-0-1178" name="__codelineno-0-1178"></a>        <span class="n">vitals_df</span><span class="o">=</span><span class="n">vitals_df</span><span class="p">,</span>
<a id="__codelineno-0-1179" name="__codelineno-0-1179"></a>        <span class="n">preferred_units</span><span class="o">=</span><span class="n">preferred_units</span><span class="p">,</span>
<a id="__codelineno-0-1180" name="__codelineno-0-1180"></a>        <span class="n">show_intermediate</span><span class="o">=</span><span class="n">show_intermediate</span><span class="p">,</span>
<a id="__codelineno-0-1181" name="__codelineno-0-1181"></a>        <span class="n">override</span><span class="o">=</span><span class="n">override</span>
<a id="__codelineno-0-1182" name="__codelineno-0-1182"></a>    <span class="p">)</span>
<a id="__codelineno-0-1183" name="__codelineno-0-1183"></a>
<a id="__codelineno-0-1184" name="__codelineno-0-1184"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Dose unit conversion completed&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1185" name="__codelineno-0-1185"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Output DataFrame shape: </span><span class="si">{</span><span class="n">converted_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1186" name="__codelineno-0-1186"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Conversion counts summary: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">counts_df</span><span class="p">)</span><span class="si">}</span><span class="s2"> conversions tracked&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1187" name="__codelineno-0-1187"></a>
<a id="__codelineno-0-1188" name="__codelineno-0-1188"></a>    <span class="c1"># If save_to_table is True, update the table&#39;s df_converted and store conversion_counts</span>
<a id="__codelineno-0-1189" name="__codelineno-0-1189"></a>    <span class="k">if</span> <span class="n">save_to_table</span><span class="p">:</span>
<a id="__codelineno-0-1190" name="__codelineno-0-1190"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Updating medication_admin_intermittent table with converted data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1191" name="__codelineno-0-1191"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">medication_admin_intermittent</span><span class="o">.</span><span class="n">df_converted</span> <span class="o">=</span> <span class="n">converted_df</span>
<a id="__codelineno-0-1192" name="__codelineno-0-1192"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">medication_admin_intermittent</span><span class="o">.</span><span class="n">conversion_counts</span> <span class="o">=</span> <span class="n">counts_df</span>
<a id="__codelineno-0-1193" name="__codelineno-0-1193"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Conversion counts stored as table property&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1194" name="__codelineno-0-1194"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1195" name="__codelineno-0-1195"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Returning converted data without updating table&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1196" name="__codelineno-0-1196"></a>        <span class="k">return</span> <span class="n">converted_df</span><span class="p">,</span> <span class="n">counts_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="clifpy.clif_orchestrator.ClifOrchestrator.convert_wide_to_hourly" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">convert_wide_to_hourly</span>


<a href="#clifpy.clif_orchestrator.ClifOrchestrator.convert_wide_to_hourly" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">convert_wide_to_hourly</span><span class="p">(</span><span class="n">aggregation_config</span><span class="p">,</span> <span class="n">wide_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">id_name</span><span class="o">=</span><span class="s1">&#39;hospitalization_id&#39;</span><span class="p">,</span> <span class="n">hourly_window</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_gaps</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">memory_limit</span><span class="o">=</span><span class="s1">&#39;4GB&#39;</span><span class="p">,</span> <span class="n">temp_directory</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert wide dataset to temporal aggregation using DuckDB with event-based windowing.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>aggregation_config</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.List">List</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict mapping aggregation methods to columns
Example: {
    'mean': ['heart_rate', 'sbp'],
    'max': ['spo2'],
    'min': ['map'],
    'median': ['glucose'],
    'first': ['gcs_total'],
    'last': ['assessment_value'],
    'boolean': ['norepinephrine'],
    'one_hot_encode': ['device_category']
}</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>wide_df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Wide dataset DataFrame. If None, uses the stored wide_df from create_wide_dataset()</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>id_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column name to use for grouping aggregation. Options:
- 'hospitalization_id': Group by individual hospitalizations (default)
- 'encounter_block': Group by encounter blocks (after encounter stitching)
- Any other ID column present in the wide dataset</p>
              </div>
            </td>
            <td>
                  <code>&#39;hospitalization_id&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>hourly_window</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Aggregation window size in hours (1-72). Windows start from each
group's first event, not calendar boundaries.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fill_gaps</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Create rows for windows with no data (filled with NaN).
False = sparse output (current behavior), True = dense output.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>memory_limit</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DuckDB memory limit (e.g., '4GB', '8GB')</p>
              </div>
            </td>
            <td>
                  <code>&#39;4GB&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>temp_directory</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory for DuckDB temp files</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>batch_size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Process in batches if specified</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Aggregated DataFrame with columns:
- window_number: Sequential window index (0-indexed)
- window_start_dttm: Window start timestamp
- window_end_dttm: Window end timestamp
- All aggregated columns per config</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Standard hourly with sparse output (only windows with data)::</p>
<div class="highlight"><pre><span></span><code>co.create_wide_dataset(...)
hourly_df = co.convert_wide_to_hourly(
    aggregation_config=config,
    hourly_window=1,
    fill_gaps=False
)
</code></pre></div>
<p>6-hour windows with gap filling (all windows 0 to max)::</p>
<div class="highlight"><pre><span></span><code>hourly_df = co.convert_wide_to_hourly(
    aggregation_config=config,
    hourly_window=6,
    fill_gaps=True
)
# If data exists at windows 0, 1, 5:
# - fill_gaps=False creates 3 rows (0, 1, 5)
# - fill_gaps=True creates 6 rows (0, 1, 2, 3, 4, 5) with NaN in 2-4
</code></pre></div>
<p>Using encounter blocks after stitching::</p>
<div class="highlight"><pre><span></span><code>co.run_stitch_encounters()
co.create_wide_dataset(...)
hourly_df = co.convert_wide_to_hourly(
    aggregation_config=config,
    id_name=&#39;encounter_block&#39;,
    hourly_window=12
)
</code></pre></div>
<p>Using explicit wide_df parameter::</p>
<div class="highlight"><pre><span></span><code>hourly_df = co.convert_wide_to_hourly(
    wide_df=my_df,
    aggregation_config=config,
    hourly_window=24
)
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>clifpy/clif_orchestrator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span>
<span class="normal"><a href="#__codelineno-0-849">849</a></span>
<span class="normal"><a href="#__codelineno-0-850">850</a></span>
<span class="normal"><a href="#__codelineno-0-851">851</a></span>
<span class="normal"><a href="#__codelineno-0-852">852</a></span>
<span class="normal"><a href="#__codelineno-0-853">853</a></span>
<span class="normal"><a href="#__codelineno-0-854">854</a></span>
<span class="normal"><a href="#__codelineno-0-855">855</a></span>
<span class="normal"><a href="#__codelineno-0-856">856</a></span>
<span class="normal"><a href="#__codelineno-0-857">857</a></span>
<span class="normal"><a href="#__codelineno-0-858">858</a></span>
<span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span>
<span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span>
<span class="normal"><a href="#__codelineno-0-865">865</a></span>
<span class="normal"><a href="#__codelineno-0-866">866</a></span>
<span class="normal"><a href="#__codelineno-0-867">867</a></span>
<span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span>
<span class="normal"><a href="#__codelineno-0-873">873</a></span>
<span class="normal"><a href="#__codelineno-0-874">874</a></span>
<span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span>
<span class="normal"><a href="#__codelineno-0-877">877</a></span>
<span class="normal"><a href="#__codelineno-0-878">878</a></span>
<span class="normal"><a href="#__codelineno-0-879">879</a></span>
<span class="normal"><a href="#__codelineno-0-880">880</a></span>
<span class="normal"><a href="#__codelineno-0-881">881</a></span>
<span class="normal"><a href="#__codelineno-0-882">882</a></span>
<span class="normal"><a href="#__codelineno-0-883">883</a></span>
<span class="normal"><a href="#__codelineno-0-884">884</a></span>
<span class="normal"><a href="#__codelineno-0-885">885</a></span>
<span class="normal"><a href="#__codelineno-0-886">886</a></span>
<span class="normal"><a href="#__codelineno-0-887">887</a></span>
<span class="normal"><a href="#__codelineno-0-888">888</a></span>
<span class="normal"><a href="#__codelineno-0-889">889</a></span>
<span class="normal"><a href="#__codelineno-0-890">890</a></span>
<span class="normal"><a href="#__codelineno-0-891">891</a></span>
<span class="normal"><a href="#__codelineno-0-892">892</a></span>
<span class="normal"><a href="#__codelineno-0-893">893</a></span>
<span class="normal"><a href="#__codelineno-0-894">894</a></span>
<span class="normal"><a href="#__codelineno-0-895">895</a></span>
<span class="normal"><a href="#__codelineno-0-896">896</a></span>
<span class="normal"><a href="#__codelineno-0-897">897</a></span>
<span class="normal"><a href="#__codelineno-0-898">898</a></span>
<span class="normal"><a href="#__codelineno-0-899">899</a></span>
<span class="normal"><a href="#__codelineno-0-900">900</a></span>
<span class="normal"><a href="#__codelineno-0-901">901</a></span>
<span class="normal"><a href="#__codelineno-0-902">902</a></span>
<span class="normal"><a href="#__codelineno-0-903">903</a></span>
<span class="normal"><a href="#__codelineno-0-904">904</a></span>
<span class="normal"><a href="#__codelineno-0-905">905</a></span>
<span class="normal"><a href="#__codelineno-0-906">906</a></span>
<span class="normal"><a href="#__codelineno-0-907">907</a></span>
<span class="normal"><a href="#__codelineno-0-908">908</a></span>
<span class="normal"><a href="#__codelineno-0-909">909</a></span>
<span class="normal"><a href="#__codelineno-0-910">910</a></span>
<span class="normal"><a href="#__codelineno-0-911">911</a></span>
<span class="normal"><a href="#__codelineno-0-912">912</a></span>
<span class="normal"><a href="#__codelineno-0-913">913</a></span>
<span class="normal"><a href="#__codelineno-0-914">914</a></span>
<span class="normal"><a href="#__codelineno-0-915">915</a></span>
<span class="normal"><a href="#__codelineno-0-916">916</a></span>
<span class="normal"><a href="#__codelineno-0-917">917</a></span>
<span class="normal"><a href="#__codelineno-0-918">918</a></span>
<span class="normal"><a href="#__codelineno-0-919">919</a></span>
<span class="normal"><a href="#__codelineno-0-920">920</a></span>
<span class="normal"><a href="#__codelineno-0-921">921</a></span>
<span class="normal"><a href="#__codelineno-0-922">922</a></span>
<span class="normal"><a href="#__codelineno-0-923">923</a></span>
<span class="normal"><a href="#__codelineno-0-924">924</a></span>
<span class="normal"><a href="#__codelineno-0-925">925</a></span>
<span class="normal"><a href="#__codelineno-0-926">926</a></span>
<span class="normal"><a href="#__codelineno-0-927">927</a></span>
<span class="normal"><a href="#__codelineno-0-928">928</a></span>
<span class="normal"><a href="#__codelineno-0-929">929</a></span>
<span class="normal"><a href="#__codelineno-0-930">930</a></span>
<span class="normal"><a href="#__codelineno-0-931">931</a></span>
<span class="normal"><a href="#__codelineno-0-932">932</a></span>
<span class="normal"><a href="#__codelineno-0-933">933</a></span>
<span class="normal"><a href="#__codelineno-0-934">934</a></span>
<span class="normal"><a href="#__codelineno-0-935">935</a></span>
<span class="normal"><a href="#__codelineno-0-936">936</a></span>
<span class="normal"><a href="#__codelineno-0-937">937</a></span>
<span class="normal"><a href="#__codelineno-0-938">938</a></span>
<span class="normal"><a href="#__codelineno-0-939">939</a></span>
<span class="normal"><a href="#__codelineno-0-940">940</a></span>
<span class="normal"><a href="#__codelineno-0-941">941</a></span>
<span class="normal"><a href="#__codelineno-0-942">942</a></span>
<span class="normal"><a href="#__codelineno-0-943">943</a></span>
<span class="normal"><a href="#__codelineno-0-944">944</a></span>
<span class="normal"><a href="#__codelineno-0-945">945</a></span>
<span class="normal"><a href="#__codelineno-0-946">946</a></span>
<span class="normal"><a href="#__codelineno-0-947">947</a></span>
<span class="normal"><a href="#__codelineno-0-948">948</a></span>
<span class="normal"><a href="#__codelineno-0-949">949</a></span>
<span class="normal"><a href="#__codelineno-0-950">950</a></span>
<span class="normal"><a href="#__codelineno-0-951">951</a></span>
<span class="normal"><a href="#__codelineno-0-952">952</a></span>
<span class="normal"><a href="#__codelineno-0-953">953</a></span>
<span class="normal"><a href="#__codelineno-0-954">954</a></span>
<span class="normal"><a href="#__codelineno-0-955">955</a></span>
<span class="normal"><a href="#__codelineno-0-956">956</a></span>
<span class="normal"><a href="#__codelineno-0-957">957</a></span>
<span class="normal"><a href="#__codelineno-0-958">958</a></span>
<span class="normal"><a href="#__codelineno-0-959">959</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-841" name="__codelineno-0-841"></a><span class="k">def</span><span class="w"> </span><span class="nf">convert_wide_to_hourly</span><span class="p">(</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a>    <span class="n">aggregation_config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a>    <span class="n">wide_df</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a>    <span class="n">id_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;hospitalization_id&#39;</span><span class="p">,</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a>    <span class="n">hourly_window</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a>    <span class="n">fill_gaps</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a>    <span class="n">memory_limit</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;4GB&#39;</span><span class="p">,</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a>    <span class="n">temp_directory</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a>    <span class="n">batch_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a><span class="sd">    Convert wide dataset to temporal aggregation using DuckDB with event-based windowing.</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a><span class="sd">    aggregation_config : Dict[str, List[str]]</span>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a><span class="sd">        Dict mapping aggregation methods to columns</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a><span class="sd">        Example: {</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a><span class="sd">            &#39;mean&#39;: [&#39;heart_rate&#39;, &#39;sbp&#39;],</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a><span class="sd">            &#39;max&#39;: [&#39;spo2&#39;],</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a><span class="sd">            &#39;min&#39;: [&#39;map&#39;],</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a><span class="sd">            &#39;median&#39;: [&#39;glucose&#39;],</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a><span class="sd">            &#39;first&#39;: [&#39;gcs_total&#39;],</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a><span class="sd">            &#39;last&#39;: [&#39;assessment_value&#39;],</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a><span class="sd">            &#39;boolean&#39;: [&#39;norepinephrine&#39;],</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a><span class="sd">            &#39;one_hot_encode&#39;: [&#39;device_category&#39;]</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a><span class="sd">        }</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a><span class="sd">    wide_df : pd.DataFrame, optional</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a><span class="sd">        Wide dataset DataFrame. If None, uses the stored wide_df from create_wide_dataset()</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a><span class="sd">    id_name : str, default=&#39;hospitalization_id&#39;</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a><span class="sd">        Column name to use for grouping aggregation. Options:</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a><span class="sd">        - &#39;hospitalization_id&#39;: Group by individual hospitalizations (default)</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a><span class="sd">        - &#39;encounter_block&#39;: Group by encounter blocks (after encounter stitching)</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a><span class="sd">        - Any other ID column present in the wide dataset</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a><span class="sd">    hourly_window : int, default=1</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a><span class="sd">        Aggregation window size in hours (1-72). Windows start from each</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a><span class="sd">        group&#39;s first event, not calendar boundaries.</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a><span class="sd">    fill_gaps : bool, default=False</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a><span class="sd">        Create rows for windows with no data (filled with NaN).</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a><span class="sd">        False = sparse output (current behavior), True = dense output.</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a><span class="sd">    memory_limit : str, default=&#39;4GB&#39;</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a><span class="sd">        DuckDB memory limit (e.g., &#39;4GB&#39;, &#39;8GB&#39;)</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a><span class="sd">    temp_directory : str, optional</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a><span class="sd">        Directory for DuckDB temp files</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a><span class="sd">    batch_size : int, optional</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a><span class="sd">        Process in batches if specified</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a><span class="sd">    -------</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a><span class="sd">    pd.DataFrame</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a><span class="sd">        Aggregated DataFrame with columns:</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a><span class="sd">        - window_number: Sequential window index (0-indexed)</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a><span class="sd">        - window_start_dttm: Window start timestamp</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a><span class="sd">        - window_end_dttm: Window end timestamp</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a><span class="sd">        - All aggregated columns per config</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a><span class="sd">    --------</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a><span class="sd">    Standard hourly with sparse output (only windows with data)::</span>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a><span class="sd">        co.create_wide_dataset(...)</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a><span class="sd">        hourly_df = co.convert_wide_to_hourly(</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a><span class="sd">            aggregation_config=config,</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a><span class="sd">            hourly_window=1,</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a><span class="sd">            fill_gaps=False</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a><span class="sd">        )</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a><span class="sd">    6-hour windows with gap filling (all windows 0 to max)::</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a><span class="sd">        hourly_df = co.convert_wide_to_hourly(</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a><span class="sd">            aggregation_config=config,</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a><span class="sd">            hourly_window=6,</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a><span class="sd">            fill_gaps=True</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a><span class="sd">        )</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a><span class="sd">        # If data exists at windows 0, 1, 5:</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a><span class="sd">        # - fill_gaps=False creates 3 rows (0, 1, 5)</span>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a><span class="sd">        # - fill_gaps=True creates 6 rows (0, 1, 2, 3, 4, 5) with NaN in 2-4</span>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a><span class="sd">    Using encounter blocks after stitching::</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a><span class="sd">        co.run_stitch_encounters()</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a><span class="sd">        co.create_wide_dataset(...)</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">        hourly_df = co.convert_wide_to_hourly(</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a><span class="sd">            aggregation_config=config,</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a><span class="sd">            id_name=&#39;encounter_block&#39;,</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a><span class="sd">            hourly_window=12</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a><span class="sd">        )</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a><span class="sd">    Using explicit wide_df parameter::</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a><span class="sd">        hourly_df = co.convert_wide_to_hourly(</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a><span class="sd">            wide_df=my_df,</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a><span class="sd">            aggregation_config=config,</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a><span class="sd">            hourly_window=24</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a><span class="sd">        )</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">clifpy.utils.wide_dataset</span><span class="w"> </span><span class="kn">import</span> <span class="n">convert_wide_to_hourly</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a>    <span class="c1"># Use provided wide_df or fall back to stored one</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a>    <span class="k">if</span> <span class="n">wide_df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">wide_df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a>                <span class="s2">&quot;No wide dataset found. Please either:</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a>                <span class="s2">&quot;1. Run create_wide_dataset() first, OR</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>                <span class="s2">&quot;2. Provide a wide_df parameter&quot;</span>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a>            <span class="p">)</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a>        <span class="n">wide_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wide_df</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a>    <span class="k">return</span> <span class="n">convert_wide_to_hourly</span><span class="p">(</span>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a>        <span class="n">wide_df</span><span class="o">=</span><span class="n">wide_df</span><span class="p">,</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a>        <span class="n">aggregation_config</span><span class="o">=</span><span class="n">aggregation_config</span><span class="p">,</span>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a>        <span class="n">id_name</span><span class="o">=</span><span class="n">id_name</span><span class="p">,</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>        <span class="n">hourly_window</span><span class="o">=</span><span class="n">hourly_window</span><span class="p">,</span>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a>        <span class="n">fill_gaps</span><span class="o">=</span><span class="n">fill_gaps</span><span class="p">,</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a>        <span class="n">memory_limit</span><span class="o">=</span><span class="n">memory_limit</span><span class="p">,</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a>        <span class="n">temp_directory</span><span class="o">=</span><span class="n">temp_directory</span><span class="p">,</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a>        <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="clifpy.clif_orchestrator.ClifOrchestrator.create_wide_dataset" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">create_wide_dataset</span>


<a href="#clifpy.clif_orchestrator.ClifOrchestrator.create_wide_dataset" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">create_wide_dataset</span><span class="p">(</span><span class="n">tables_to_load</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">category_filters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sample</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hospitalization_ids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encounter_blocks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cohort_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="s1">&#39;dataframe&#39;</span><span class="p">,</span> <span class="n">save_to_data_location</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">output_filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_dataframe</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">memory_limit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create wide time-series dataset using DuckDB for high performance.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tables_to_load</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of table names to include in the wide dataset (e.g., ['vitals', 'labs', 'respiratory_support']).
If None, only base tables (patient, hospitalization, adt) are loaded.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>category_filters</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.List">List</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping table names to lists for filtering/selection. Behavior differs
by table type:</p>
<p><strong>PIVOT TABLES</strong> (narrow to wide - category values from schema):
- Values are <strong>category values</strong> to filter and pivot into columns
- Examples:
  * vitals: temp_c, heart_rate, sbp, dbp, spo2, respiratory_rate, map
  * labs: hemoglobin, wbc, sodium, potassium, creatinine, glucose_serum, lactate
  * medication_admin_continuous: norepinephrine, epinephrine, propofol, fentanyl
  * patient_assessments: RASS, gcs_total, cam_total, braden_total</p>
<p><strong>WIDE TABLES</strong> (already wide - column names from schema):
- Values are <strong>column names</strong> to keep from the table
- Examples:
  * respiratory_support: device_category, mode_category, fio2_set, peep_set</p>
<p>Usage Example:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">category_filters</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="s1">&#39;vitals&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;heart_rate&#39;</span><span class="p">,</span> <span class="s1">&#39;sbp&#39;</span><span class="p">,</span> <span class="s1">&#39;spo2&#39;</span><span class="p">],</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="s1">&#39;labs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;hemoglobin&#39;</span><span class="p">,</span> <span class="s1">&#39;sodium&#39;</span><span class="p">,</span> <span class="s1">&#39;creatinine&#39;</span><span class="p">],</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="s1">&#39;respiratory_support&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;device_category&#39;</span><span class="p">,</span> <span class="s1">&#39;fio2_set&#39;</span><span class="p">,</span> <span class="s1">&#39;peep_set&#39;</span><span class="p">]</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="p">}</span>
</code></pre></div></p>
<p><strong>Supported Tables:</strong>
For complete list of supported tables and their types, see:
clifpy/schemas/wide_tables_config.yaml</p>
<p><strong>Category Values:</strong>
For complete lists of acceptable category values, see:
- Table schemas: clifpy/schemas/*_schema.yaml
- Use <code>co.vitals.df['vital_category'].unique()</code> to see available values in your data</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sample</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, randomly sample 20 hospitalizations for testing purposes.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>hospitalization_ids</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of specific hospitalization IDs to include. When provided, only data for these
hospitalizations will be loaded, improving performance for large datasets.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>encounter_blocks</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of encounter block IDs to include when encounter stitching has been performed.
Automatically converts encounter blocks to their corresponding hospitalization IDs.
Only used when encounter stitching is enabled and encounter mapping exists.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cohort_df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame containing cohort definitions with columns:</p>
<ul>
<li>'patient_id': Patient identifier</li>
<li>'start_time': Start of time window (datetime)</li>
<li>'end_time': End of time window (datetime)</li>
</ul>
<p>When encounter stitching is enabled, can also include 'encounter_block' column.
Used to filter data to specific time windows per patient.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_format</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Format for output data. Options: 'dataframe', 'csv', 'parquet'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;dataframe&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>save_to_data_location</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, save output file to the data directory specified in orchestrator config.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Custom filename for saved output. If None, auto-generates filename with timestamp.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_dataframe</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, return DataFrame even when saving to file. If False and saving,
returns None to save memory.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>batch_size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of hospitalizations to process per batch. Lower values use less memory.</p>
              </div>
            </td>
            <td>
                  <code>1000</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>memory_limit</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DuckDB memory limit (e.g., '8GB', '16GB'). If None, uses DuckDB default.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>threads</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of threads for DuckDB to use. If None, uses all available cores.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_progress</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, display progress bars during processing.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The wide dataset is stored in the <code>wide_df</code> property of the orchestrator instance.
Access the result via <code>orchestrator.wide_df</code> after calling this method.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <ul>
<li>When hospitalization_ids is provided, the function efficiently loads only the
  specified hospitalizations from all tables, significantly reducing memory usage
  and processing time for targeted analyses.</li>
<li>The wide dataset will have one row per hospitalization per time point, with
  columns for each category value specified in category_filters.</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>clifpy/clif_orchestrator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span>
<span class="normal"><a href="#__codelineno-0-797">797</a></span>
<span class="normal"><a href="#__codelineno-0-798">798</a></span>
<span class="normal"><a href="#__codelineno-0-799">799</a></span>
<span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span>
<span class="normal"><a href="#__codelineno-0-804">804</a></span>
<span class="normal"><a href="#__codelineno-0-805">805</a></span>
<span class="normal"><a href="#__codelineno-0-806">806</a></span>
<span class="normal"><a href="#__codelineno-0-807">807</a></span>
<span class="normal"><a href="#__codelineno-0-808">808</a></span>
<span class="normal"><a href="#__codelineno-0-809">809</a></span>
<span class="normal"><a href="#__codelineno-0-810">810</a></span>
<span class="normal"><a href="#__codelineno-0-811">811</a></span>
<span class="normal"><a href="#__codelineno-0-812">812</a></span>
<span class="normal"><a href="#__codelineno-0-813">813</a></span>
<span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span>
<span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span>
<span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span>
<span class="normal"><a href="#__codelineno-0-831">831</a></span>
<span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span>
<span class="normal"><a href="#__codelineno-0-835">835</a></span>
<span class="normal"><a href="#__codelineno-0-836">836</a></span>
<span class="normal"><a href="#__codelineno-0-837">837</a></span>
<span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_wide_dataset</span><span class="p">(</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>    <span class="n">tables_to_load</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>    <span class="n">category_filters</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>    <span class="n">sample</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>    <span class="n">hospitalization_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>    <span class="n">encounter_blocks</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>    <span class="n">cohort_df</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>    <span class="n">output_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;dataframe&#39;</span><span class="p">,</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>    <span class="n">save_to_data_location</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>    <span class="n">output_filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>    <span class="n">return_dataframe</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>    <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>    <span class="n">memory_limit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>    <span class="n">threads</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="sd">    Create wide time-series dataset using DuckDB for high performance.</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a><span class="sd">    tables_to_load : List[str], optional</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="sd">        List of table names to include in the wide dataset (e.g., [&#39;vitals&#39;, &#39;labs&#39;, &#39;respiratory_support&#39;]).</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">        If None, only base tables (patient, hospitalization, adt) are loaded.</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="sd">    category_filters : Dict[str, List[str]], optional</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a><span class="sd">        Dictionary mapping table names to lists for filtering/selection. Behavior differs</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="sd">        by table type:</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="sd">        **PIVOT TABLES** (narrow to wide - category values from schema):</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">        - Values are **category values** to filter and pivot into columns</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="sd">        - Examples:</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">          * vitals: temp_c, heart_rate, sbp, dbp, spo2, respiratory_rate, map</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="sd">          * labs: hemoglobin, wbc, sodium, potassium, creatinine, glucose_serum, lactate</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">          * medication_admin_continuous: norepinephrine, epinephrine, propofol, fentanyl</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="sd">          * patient_assessments: RASS, gcs_total, cam_total, braden_total</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">        **WIDE TABLES** (already wide - column names from schema):</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="sd">        - Values are **column names** to keep from the table</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a><span class="sd">        - Examples:</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="sd">          * respiratory_support: device_category, mode_category, fio2_set, peep_set</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a><span class="sd">        Usage Example:</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="sd">        category_filters = {</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a><span class="sd">            &#39;vitals&#39;: [&#39;heart_rate&#39;, &#39;sbp&#39;, &#39;spo2&#39;],</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a><span class="sd">            &#39;labs&#39;: [&#39;hemoglobin&#39;, &#39;sodium&#39;, &#39;creatinine&#39;],</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="sd">            &#39;respiratory_support&#39;: [&#39;device_category&#39;, &#39;fio2_set&#39;, &#39;peep_set&#39;]</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a><span class="sd">        }</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a><span class="sd">        ```</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a><span class="sd">        **Supported Tables:**</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a><span class="sd">        For complete list of supported tables and their types, see:</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">        clifpy/schemas/wide_tables_config.yaml</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="sd">        **Category Values:**</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="sd">        For complete lists of acceptable category values, see:</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="sd">        - Table schemas: clifpy/schemas/*_schema.yaml</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a><span class="sd">        - Use `co.vitals.df[&#39;vital_category&#39;].unique()` to see available values in your data</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a><span class="sd">    sample : bool, default=False</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="sd">        If True, randomly sample 20 hospitalizations for testing purposes.</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a><span class="sd">    hospitalization_ids : List[str], optional</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a><span class="sd">        List of specific hospitalization IDs to include. When provided, only data for these</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a><span class="sd">        hospitalizations will be loaded, improving performance for large datasets.</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="sd">    encounter_blocks : List[int], optional</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="sd">        List of encounter block IDs to include when encounter stitching has been performed.</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a><span class="sd">        Automatically converts encounter blocks to their corresponding hospitalization IDs.</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">        Only used when encounter stitching is enabled and encounter mapping exists.</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="sd">    cohort_df : pd.DataFrame, optional</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a><span class="sd">        DataFrame containing cohort definitions with columns:</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="sd">        - &#39;patient_id&#39;: Patient identifier</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="sd">        - &#39;start_time&#39;: Start of time window (datetime)</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">        - &#39;end_time&#39;: End of time window (datetime)</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a><span class="sd">        When encounter stitching is enabled, can also include &#39;encounter_block&#39; column.</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a><span class="sd">        Used to filter data to specific time windows per patient.</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a><span class="sd">    output_format : str, default=&#39;dataframe&#39;</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a><span class="sd">        Format for output data. Options: &#39;dataframe&#39;, &#39;csv&#39;, &#39;parquet&#39;.</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a><span class="sd">    save_to_data_location : bool, default=False</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a><span class="sd">        If True, save output file to the data directory specified in orchestrator config.</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a><span class="sd">    output_filename : str, optional</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a><span class="sd">        Custom filename for saved output. If None, auto-generates filename with timestamp.</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a><span class="sd">    return_dataframe : bool, default=True</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a><span class="sd">        If True, return DataFrame even when saving to file. If False and saving,</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a><span class="sd">        returns None to save memory.</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a><span class="sd">    batch_size : int, default=1000</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a><span class="sd">        Number of hospitalizations to process per batch. Lower values use less memory.</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a><span class="sd">    memory_limit : str, optional</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a><span class="sd">        DuckDB memory limit (e.g., &#39;8GB&#39;, &#39;16GB&#39;). If None, uses DuckDB default.</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a><span class="sd">    threads : int, optional</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a><span class="sd">        Number of threads for DuckDB to use. If None, uses all available cores.</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a><span class="sd">    show_progress : bool, default=True</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a><span class="sd">        If True, display progress bars during processing.</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a><span class="sd">    -------</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a><span class="sd">    None</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a><span class="sd">        The wide dataset is stored in the `wide_df` property of the orchestrator instance.</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a><span class="sd">        Access the result via `orchestrator.wide_df` after calling this method.</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a><span class="sd">    Notes</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a><span class="sd">    -----</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a><span class="sd">    - When hospitalization_ids is provided, the function efficiently loads only the</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a><span class="sd">      specified hospitalizations from all tables, significantly reducing memory usage</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a><span class="sd">      and processing time for targeted analyses.</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="sd">    - The wide dataset will have one row per hospitalization per time point, with</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="sd">      columns for each category value specified in category_filters.</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;🚀 WIDE DATASET CREATION STARTED&quot;</span><span class="p">)</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Phase 1: Initialization&quot;</span><span class="p">)</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;  1.1: Validating parameters&quot;</span><span class="p">)</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>    <span class="c1"># Import the utility function</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">clifpy.utils.wide_dataset</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_wide_dataset</span> <span class="k">as</span> <span class="n">_create_wide</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>    <span class="c1"># Handle encounter stitching scenarios</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">encounter_mapping</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  1.2: Configuring encounter stitching (enabled)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;  1.2: Encounter stitching (disabled)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Phase 2: Encounter Processing&quot;</span><span class="p">)</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">encounter_mapping</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  2.1: === SPECIAL: ENCOUNTER STITCHING ===&quot;</span><span class="p">)</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>        <span class="c1"># Handle cohort_df with encounter_block column</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>        <span class="k">if</span> <span class="n">cohort_df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>            <span class="k">if</span> <span class="s1">&#39;encounter_block&#39;</span> <span class="ow">in</span> <span class="n">cohort_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;       - Detected encounter_block column in cohort_df&quot;</span><span class="p">)</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;       - Mapping encounter blocks to hospitalization IDs&quot;</span><span class="p">)</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>                <span class="c1"># Merge cohort_df with encounter_mapping to get hospitalization_ids</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>                <span class="n">cohort_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>                    <span class="n">cohort_df</span><span class="p">,</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">encounter_mapping</span><span class="p">[[</span><span class="s1">&#39;hospitalization_id&#39;</span><span class="p">,</span> <span class="s1">&#39;encounter_block&#39;</span><span class="p">]],</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>                    <span class="n">on</span><span class="o">=</span><span class="s1">&#39;encounter_block&#39;</span><span class="p">,</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>                    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>                    <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;_orig&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>                <span class="p">)</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>                <span class="c1"># If hospitalization_id_orig exists (cohort had both), use the mapping version</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>                <span class="k">if</span> <span class="s1">&#39;hospitalization_id_orig&#39;</span> <span class="ow">in</span> <span class="n">cohort_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>                    <span class="n">cohort_df</span> <span class="o">=</span> <span class="n">cohort_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;hospitalization_id_orig&#39;</span><span class="p">])</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;       - Processing </span><span class="si">{</span><span class="n">cohort_df</span><span class="p">[</span><span class="s1">&#39;encounter_block&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="si">}</span><span class="s2"> encounter blocks from cohort_df&quot;</span><span class="p">)</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>            <span class="k">elif</span> <span class="s1">&#39;hospitalization_id&#39;</span> <span class="ow">in</span> <span class="n">cohort_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Encounter stitching has been performed. Your cohort_df uses hospitalization_id. &quot;</span> <span class="o">+</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>                      <span class="s2">&quot;Consider using &#39;encounter_block&#39; column instead for cleaner encounter-level filtering&quot;</span><span class="p">)</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;cohort_df must contain either &#39;hospitalization_id&#39; or &#39;encounter_block&#39; column&quot;</span><span class="p">)</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>        <span class="c1"># Handle encounter_blocks parameter</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>        <span class="k">if</span> <span class="n">encounter_blocks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;       - Processing encounter_blocks parameter&quot;</span><span class="p">)</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">encounter_blocks</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;       - Empty encounter_blocks list provided. Processing all encounter blocks&quot;</span><span class="p">)</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>                <span class="n">encounter_blocks</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>                <span class="c1"># Validate that provided encounter_blocks exist in mapping</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>                <span class="n">invalid_blocks</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">encounter_blocks</span> <span class="k">if</span> <span class="n">b</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">encounter_mapping</span><span class="p">[</span><span class="s1">&#39;encounter_block&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>                <span class="k">if</span> <span class="n">invalid_blocks</span><span class="p">:</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;       - Invalid encounter blocks found: </span><span class="si">{</span><span class="n">invalid_blocks</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>                    <span class="n">encounter_blocks</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">encounter_blocks</span> <span class="k">if</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">encounter_mapping</span><span class="p">[</span><span class="s1">&#39;encounter_block&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>                <span class="k">if</span> <span class="n">encounter_blocks</span><span class="p">:</span>  <span class="c1"># Only if valid blocks remain</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>                    <span class="n">hospitalization_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encounter_mapping</span><span class="p">[</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">encounter_mapping</span><span class="p">[</span><span class="s1">&#39;encounter_block&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">encounter_blocks</span><span class="p">)</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>                    <span class="p">][</span><span class="s1">&#39;hospitalization_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;       - Converting </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">encounter_blocks</span><span class="p">)</span><span class="si">}</span><span class="s2"> encounter blocks to </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">hospitalization_ids</span><span class="p">)</span><span class="si">}</span><span class="s2"> hospitalizations&quot;</span><span class="p">)</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;       - No valid encounter blocks found. Processing all data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>                    <span class="n">encounter_blocks</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>        <span class="c1"># If no filters provided after stitching</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>        <span class="k">elif</span> <span class="n">hospitalization_ids</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">cohort_df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;       - No encounter_blocks provided - processing all encounter blocks&quot;</span><span class="p">)</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;  2.1: No encounter stitching performed&quot;</span><span class="p">)</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>    <span class="n">filters</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>    <span class="k">if</span> <span class="n">hospitalization_ids</span><span class="p">:</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>        <span class="n">filters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;hospitalization_id&#39;</span><span class="p">:</span> <span class="n">hospitalization_ids</span><span class="p">}</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Phase 3: Table Loading&quot;</span><span class="p">)</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  3.1: Auto-loading base tables&quot;</span><span class="p">)</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>    <span class="c1"># Auto-load base tables if not loaded</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">patient</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;       - Loading patient table&quot;</span><span class="p">)</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">load_table</span><span class="p">(</span><span class="s1">&#39;patient&#39;</span><span class="p">)</span>  <span class="c1"># Patient doesn&#39;t need filters</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hospitalization</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;       - Loading hospitalization table&quot;</span><span class="p">)</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">load_table</span><span class="p">(</span><span class="s1">&#39;hospitalization&#39;</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">)</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">adt</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;       - Loading adt table&quot;</span><span class="p">)</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">load_table</span><span class="p">(</span><span class="s1">&#39;adt&#39;</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">)</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>    <span class="c1"># Load optional tables only if not already loaded</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  3.2: Loading optional tables: </span><span class="si">{</span><span class="n">tables_to_load</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;None&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>    <span class="k">if</span> <span class="n">tables_to_load</span><span class="p">:</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>        <span class="k">for</span> <span class="n">table_name</span> <span class="ow">in</span> <span class="n">tables_to_load</span><span class="p">:</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>            <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;       - Loading </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2"> table&quot;</span><span class="p">)</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>                <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">load_table</span><span class="p">(</span><span class="n">table_name</span><span class="p">)</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;       - Could not load </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;       - </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2"> table already loaded&quot;</span><span class="p">)</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>    <span class="c1"># Check if patient_assessments needs assessment_value column</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">tables_to_load</span> <span class="ow">and</span> <span class="s1">&#39;patient_assessments&#39;</span> <span class="ow">in</span> <span class="n">tables_to_load</span><span class="p">)</span> <span class="ow">or</span> \
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>       <span class="p">(</span><span class="n">category_filters</span> <span class="ow">and</span> <span class="s1">&#39;patient_assessments&#39;</span> <span class="ow">in</span> <span class="n">category_filters</span><span class="p">):</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">patient_assessments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">patient_assessments</span><span class="p">,</span> <span class="s1">&#39;df&#39;</span><span class="p">):</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">patient_assessments</span><span class="o">.</span><span class="n">df</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a>            <span class="k">if</span> <span class="s1">&#39;numerical_value&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="s1">&#39;categorical_value&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>                <span class="k">if</span> <span class="s1">&#39;assessment_value&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  === SPECIAL: PATIENT ASSESSMENTS PROCESSING ===&quot;</span><span class="p">)</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;       - Merging numerical_value and categorical_value columns&quot;</span><span class="p">)</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a>                    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>                        <span class="kn">import</span><span class="w"> </span><span class="nn">polars</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pl</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;       - Using Polars for performance optimization&quot;</span><span class="p">)</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>                        <span class="c1"># Convert to Polars for efficient processing</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>                        <span class="n">df_pl</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>                        <span class="c1"># Check data integrity using Polars</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>                        <span class="n">both_filled</span> <span class="o">=</span> <span class="n">df_pl</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>                            <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;numerical_value&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_not_null</span><span class="p">())</span> <span class="o">&amp;</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>                            <span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;categorical_value&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_not_null</span><span class="p">())</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>                        <span class="p">)</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>                        <span class="n">both_filled_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">both_filled</span><span class="p">)</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>                        <span class="k">if</span> <span class="n">both_filled_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;       - Found </span><span class="si">{</span><span class="n">both_filled_count</span><span class="si">}</span><span class="s2"> rows with both numerical and categorical values - numerical values will take precedence&quot;</span><span class="p">)</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>                        <span class="c1"># Create assessment_value using Polars coalesce (much faster than pandas fillna)</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>                        <span class="n">df_pl</span> <span class="o">=</span> <span class="n">df_pl</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>                            <span class="n">pl</span><span class="o">.</span><span class="n">coalesce</span><span class="p">([</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a>                                <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;numerical_value&#39;</span><span class="p">),</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>                                <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;categorical_value&#39;</span><span class="p">)</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>                            <span class="p">])</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Utf8</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;assessment_value&#39;</span><span class="p">)</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a>                        <span class="p">)</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>                        <span class="c1"># Calculate statistics efficiently with Polars</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>                        <span class="n">num_count</span> <span class="o">=</span> <span class="n">df_pl</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;numerical_value&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_not_null</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a>                        <span class="n">cat_count</span> <span class="o">=</span> <span class="n">df_pl</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;categorical_value&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_not_null</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>                        <span class="n">total_count</span> <span class="o">=</span> <span class="n">df_pl</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;assessment_value&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_not_null</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>                        <span class="c1"># Convert back to pandas for compatibility</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">patient_assessments</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">df_pl</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;       - Created assessment_value column: </span><span class="si">{</span><span class="n">num_count</span><span class="si">}</span><span class="s2"> numerical, </span><span class="si">{</span><span class="n">cat_count</span><span class="si">}</span><span class="s2"> categorical, </span><span class="si">{</span><span class="n">total_count</span><span class="si">}</span><span class="s2"> total non-null&quot;</span><span class="p">)</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;       -   Stored as string type for processing compatibility&quot;</span><span class="p">)</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>                    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;       - Polars not installed. Using pandas (slower)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>                        <span class="c1"># Fallback to pandas</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>                        <span class="n">both_filled</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;numerical_value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">())</span> <span class="o">&amp;</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>                                        <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;categorical_value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">())]</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">both_filled</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;       - Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">both_filled</span><span class="p">)</span><span class="si">}</span><span class="s2"> rows with both numerical and categorical values&quot;</span><span class="p">)</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>                        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;assessment_value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;numerical_value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;categorical_value&#39;</span><span class="p">])</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>                        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;assessment_value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;assessment_value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>                        <span class="n">num_count</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;numerical_value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>                        <span class="n">cat_count</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;categorical_value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>                        <span class="n">total_count</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;assessment_value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;       - Created assessment_value column: </span><span class="si">{</span><span class="n">num_count</span><span class="si">}</span><span class="s2"> numerical, </span><span class="si">{</span><span class="n">cat_count</span><span class="si">}</span><span class="s2"> categorical, </span><span class="si">{</span><span class="n">total_count</span><span class="si">}</span><span class="s2"> total non-null&quot;</span><span class="p">)</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Phase 4: Calling Wide Dataset Utility&quot;</span><span class="p">)</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  4.1: Passing to wide_dataset.create_wide_dataset()&quot;</span><span class="p">)</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;       - Tables: </span><span class="si">{</span><span class="n">tables_to_load</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;None&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;       - Category filters: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">category_filters</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">category_filters</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;None&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;       - Batch size: </span><span class="si">{</span><span class="n">batch_size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;       - Memory limit: </span><span class="si">{</span><span class="n">memory_limit</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;       - Show progress: </span><span class="si">{</span><span class="n">show_progress</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>    <span class="c1"># Call utility function with self as clif_instance and store result in wide_df property</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">wide_df</span> <span class="o">=</span> <span class="n">_create_wide</span><span class="p">(</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>        <span class="n">clif_instance</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>        <span class="n">optional_tables</span><span class="o">=</span><span class="n">tables_to_load</span><span class="p">,</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>        <span class="n">category_filters</span><span class="o">=</span><span class="n">category_filters</span><span class="p">,</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>        <span class="n">sample</span><span class="o">=</span><span class="n">sample</span><span class="p">,</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>        <span class="n">hospitalization_ids</span><span class="o">=</span><span class="n">hospitalization_ids</span><span class="p">,</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>        <span class="n">cohort_df</span><span class="o">=</span><span class="n">cohort_df</span><span class="p">,</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a>        <span class="n">output_format</span><span class="o">=</span><span class="n">output_format</span><span class="p">,</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>        <span class="n">save_to_data_location</span><span class="o">=</span><span class="n">save_to_data_location</span><span class="p">,</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>        <span class="n">output_filename</span><span class="o">=</span><span class="n">output_filename</span><span class="p">,</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>        <span class="n">return_dataframe</span><span class="o">=</span><span class="n">return_dataframe</span><span class="p">,</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>        <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>        <span class="n">memory_limit</span><span class="o">=</span><span class="n">memory_limit</span><span class="p">,</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>        <span class="n">threads</span><span class="o">=</span><span class="n">threads</span><span class="p">,</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>        <span class="n">show_progress</span><span class="o">=</span><span class="n">show_progress</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>    <span class="p">)</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Phase 5: Post-Processing&quot;</span><span class="p">)</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>    <span class="c1"># Add encounter_block column if encounter mapping exists and not already present</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">encounter_mapping</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">wide_df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  5.1: === SPECIAL: ADDING ENCOUNTER BLOCKS ===&quot;</span><span class="p">)</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>        <span class="k">if</span> <span class="s1">&#39;encounter_block&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wide_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;       - Adding encounter_block column from encounter mapping&quot;</span><span class="p">)</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">wide_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">wide_df</span><span class="p">,</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">encounter_mapping</span><span class="p">[[</span><span class="s1">&#39;hospitalization_id&#39;</span><span class="p">,</span> <span class="s1">&#39;encounter_block&#39;</span><span class="p">]],</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>                <span class="n">on</span><span class="o">=</span><span class="s1">&#39;hospitalization_id&#39;</span><span class="p">,</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>                <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>            <span class="p">)</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;       - Added encounter_block column - </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">wide_df</span><span class="p">[</span><span class="s1">&#39;encounter_block&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="si">}</span><span class="s2"> unique encounter blocks&quot;</span><span class="p">)</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;       - Encounter_block column already present - </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">wide_df</span><span class="p">[</span><span class="s1">&#39;encounter_block&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="si">}</span><span class="s2"> unique encounter blocks&quot;</span><span class="p">)</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;  5.1: No encounter block mapping to add&quot;</span><span class="p">)</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>    <span class="c1"># Optimize data types for assessment columns using Polars for performance</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">wide_df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">((</span><span class="n">tables_to_load</span> <span class="ow">and</span> <span class="s1">&#39;patient_assessments&#39;</span> <span class="ow">in</span> <span class="n">tables_to_load</span><span class="p">)</span> <span class="ow">or</span> \
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>       <span class="p">(</span><span class="n">category_filters</span> <span class="ow">and</span> <span class="s1">&#39;patient_assessments&#39;</span> <span class="ow">in</span> <span class="n">category_filters</span><span class="p">)):</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  5.2: === SPECIAL: ASSESSMENT TYPE OPTIMIZATION ===&quot;</span><span class="p">)</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>            <span class="kn">import</span><span class="w"> </span><span class="nn">polars</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pl</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;       - Using Polars for performance optimization&quot;</span><span class="p">)</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>            <span class="c1"># Determine which assessment columns to check</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>            <span class="n">assessment_columns</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a>            <span class="k">if</span> <span class="n">category_filters</span> <span class="ow">and</span> <span class="s1">&#39;patient_assessments&#39;</span> <span class="ow">in</span> <span class="n">category_filters</span><span class="p">:</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a>                <span class="c1"># If specific categories were requested, use those</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>                <span class="n">assessment_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">category_filters</span><span class="p">[</span><span class="s1">&#39;patient_assessments&#39;</span><span class="p">]</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>                                     <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wide_df</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>                <span class="c1"># Get all possible assessment categories from the schema</span>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">patient_assessments</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">patient_assessments</span><span class="p">,</span> <span class="s1">&#39;schema&#39;</span><span class="p">):</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a>                    <span class="n">schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">patient_assessments</span><span class="o">.</span><span class="n">schema</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>                    <span class="k">if</span> <span class="s1">&#39;columns&#39;</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">:</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a>                        <span class="k">for</span> <span class="n">col_def</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;columns&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>                            <span class="k">if</span> <span class="n">col_def</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;assessment_category&#39;</span><span class="p">:</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a>                                <span class="n">assessment_columns</span> <span class="o">=</span> <span class="n">col_def</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;permissible_values&#39;</span><span class="p">,</span> <span class="p">[])</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>                                <span class="k">break</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>                <span class="c1"># Filter to only columns that exist in wide_df</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>                <span class="n">assessment_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">assessment_columns</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wide_df</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>            <span class="k">if</span> <span class="n">assessment_columns</span><span class="p">:</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;       - Analyzing </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">assessment_columns</span><span class="p">)</span><span class="si">}</span><span class="s2"> assessment columns&quot;</span><span class="p">)</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>                <span class="c1"># Convert to Polars for efficient processing</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>                <span class="n">df_pl</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wide_df</span><span class="p">)</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>                <span class="n">numeric_conversions</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>                <span class="n">string_kept</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>                <span class="c1"># Process all columns in one go for better performance</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>                <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">assessment_columns</span><span class="p">:</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a>                    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>                        <span class="c1"># Create a temporary column with numeric conversion attempt</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a>                        <span class="n">temp_col</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">_numeric_test&quot;</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>                        <span class="n">df_pl</span> <span class="o">=</span> <span class="n">df_pl</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>                            <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">Float64</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="n">temp_col</span><span class="p">)</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a>                        <span class="p">)</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>                        <span class="c1"># Check conversion success rate</span>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>                        <span class="n">stats</span> <span class="o">=</span> <span class="n">df_pl</span><span class="o">.</span><span class="n">select</span><span class="p">([</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a>                            <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">.</span><span class="n">is_not_null</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;original_count&#39;</span><span class="p">),</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a>                            <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">temp_col</span><span class="p">)</span><span class="o">.</span><span class="n">is_not_null</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;converted_count&#39;</span><span class="p">)</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a>                        <span class="p">])</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a>                        <span class="k">if</span> <span class="n">stats</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># If there are non-null values</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>                            <span class="n">conversion_rate</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">stats</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>                            <span class="k">if</span> <span class="n">conversion_rate</span> <span class="o">&gt;=</span> <span class="mf">0.95</span><span class="p">:</span>  <span class="c1"># 95% or more are numeric</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>                                <span class="c1"># Replace original with converted</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>                                <span class="n">df_pl</span> <span class="o">=</span> <span class="n">df_pl</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="n">temp_col</span><span class="p">:</span> <span class="n">col</span><span class="p">})</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>                                <span class="n">numeric_conversions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>                            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>                                <span class="c1"># Keep original, drop temp</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>                                <span class="n">df_pl</span> <span class="o">=</span> <span class="n">df_pl</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">temp_col</span><span class="p">)</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>                                <span class="n">string_kept</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a>                        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a>                            <span class="c1"># No data, just drop temp</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a>                            <span class="n">df_pl</span> <span class="o">=</span> <span class="n">df_pl</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">temp_col</span><span class="p">)</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a>                    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a>                        <span class="c1"># Keep as string if any error, clean up temp column if it exists</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a>                        <span class="k">if</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">_numeric_test&quot;</span> <span class="ow">in</span> <span class="n">df_pl</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a>                            <span class="n">df_pl</span> <span class="o">=</span> <span class="n">df_pl</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">_numeric_test&quot;</span><span class="p">)</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a>                        <span class="n">string_kept</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a>                <span class="c1"># Convert back to pandas</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">wide_df</span> <span class="o">=</span> <span class="n">df_pl</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a>                <span class="c1"># Report conversions</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a>                <span class="k">if</span> <span class="n">numeric_conversions</span><span class="p">:</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;       - Converted to numeric: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">numeric_conversions</span><span class="p">)</span><span class="si">}</span><span class="s2"> columns&quot;</span><span class="p">)</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;       -   Examples: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">numeric_conversions</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a>                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">numeric_conversions</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;       -   ... and </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">numeric_conversions</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">5</span><span class="si">}</span><span class="s2"> more&quot;</span><span class="p">)</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a>                <span class="k">if</span> <span class="n">string_kept</span><span class="p">:</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;       - Kept as string: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">string_kept</span><span class="p">)</span><span class="si">}</span><span class="s2"> columns with mixed/text values&quot;</span><span class="p">)</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;       -   Examples: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">string_kept</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a>                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">string_kept</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;       -   ... and </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">string_kept</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">5</span><span class="si">}</span><span class="s2"> more&quot;</span><span class="p">)</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;       - No assessment columns found to optimize&quot;</span><span class="p">)</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a>        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;       - Polars not installed. Skipping type optimization&quot;</span><span class="p">)</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;       - Install polars for better performance: pip install polars&quot;</span><span class="p">)</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;  5.2: No assessment type optimization needed&quot;</span><span class="p">)</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Phase 6: Completion&quot;</span><span class="p">)</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">wide_df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a>        <span class="c1"># Convert encounter_block to int32 if it exists (memory optimization)</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a>        <span class="k">if</span> <span class="s1">&#39;encounter_block&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wide_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">wide_df</span><span class="p">[</span><span class="s1">&#39;encounter_block&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wide_df</span><span class="p">[</span><span class="s1">&#39;encounter_block&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;Int32&#39;</span><span class="p">)</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  6.1: Wide dataset stored in self.wide_df&quot;</span><span class="p">)</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  6.2: Dataset shape: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">wide_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> rows x </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">wide_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> columns&quot;</span><span class="p">)</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;  6.1: No wide dataset was created&quot;</span><span class="p">)</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;✅ WIDE DATASET CREATION COMPLETED&quot;</span><span class="p">)</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="clifpy.clif_orchestrator.ClifOrchestrator.from_config" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">from_config</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#clifpy.clif_orchestrator.ClifOrchestrator.from_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">from_config</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="s1">&#39;./config.json&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create a ClifOrchestrator instance from a configuration file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the configuration JSON file</p>
              </div>
            </td>
            <td>
                  <code>&#39;./config.json&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            clifpy.clif_orchestrator.ClifOrchestrator" href="#clifpy.clif_orchestrator.ClifOrchestrator">ClifOrchestrator</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configured instance</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>clifpy/clif_orchestrator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="k">def</span><span class="w"> </span><span class="nf">from_config</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">config_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;./config.json&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;ClifOrchestrator&#39;</span><span class="p">:</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">    Create a ClifOrchestrator instance from a configuration file.</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">    config_path : str</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">        Path to the configuration JSON file</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">    -------</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">    ClifOrchestrator</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">        Configured instance</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="n">config_path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="clifpy.clif_orchestrator.ClifOrchestrator.get_encounter_mapping" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_encounter_mapping</span>


<a href="#clifpy.clif_orchestrator.ClifOrchestrator.get_encounter_mapping" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_encounter_mapping</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Return the encounter mapping DataFrame if encounter stitching was performed.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span> or None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mapping of hospitalization_id to encounter_block if stitching was performed,
None if stitching was not performed or failed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>clifpy/clif_orchestrator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-372" name="__codelineno-0-372"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_encounter_mapping</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="sd">    Return the encounter mapping DataFrame if encounter stitching was performed.</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="sd">    -------</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="sd">    pd.DataFrame or None</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">        Mapping of hospitalization_id to encounter_block if stitching was performed,</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="sd">        None if stitching was not performed or failed.</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">encounter_mapping</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">run_stitch_encounters</span><span class="p">()</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">encounter_mapping</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="clifpy.clif_orchestrator.ClifOrchestrator.get_loaded_tables" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_loaded_tables</span>


<a href="#clifpy.clif_orchestrator.ClifOrchestrator.get_loaded_tables" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_loaded_tables</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Return list of currently loaded table names.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of loaded table names</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>clifpy/clif_orchestrator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_loaded_tables</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">    Return list of currently loaded table names.</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="sd">    -------</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">    List[str]</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="sd">        List of loaded table names</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>    <span class="n">loaded</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>    <span class="k">for</span> <span class="n">table_name</span> <span class="ow">in</span> <span class="n">TABLE_CLASSES</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table_name</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>            <span class="n">loaded</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">table_name</span><span class="p">)</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>    <span class="k">return</span> <span class="n">loaded</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="clifpy.clif_orchestrator.ClifOrchestrator.get_sys_resource_info" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_sys_resource_info</span>


<a href="#clifpy.clif_orchestrator.ClifOrchestrator.get_sys_resource_info" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_sys_resource_info</span><span class="p">(</span><span class="n">print_summary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get system resource information including CPU, memory, and practical thread limits.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>print_summary</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to print a formatted summary</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary containing system resource information:</p>
<ul>
<li>cpu_count_physical: Number of physical CPU cores</li>
<li>cpu_count_logical: Number of logical CPU cores</li>
<li>cpu_usage_percent: Current CPU usage percentage</li>
<li>memory_total_gb: Total RAM in GB</li>
<li>memory_available_gb: Available RAM in GB</li>
<li>memory_used_gb: Used RAM in GB</li>
<li>memory_usage_percent: Memory usage percentage</li>
<li>process_threads: Number of threads used by current process</li>
<li>max_recommended_threads: Recommended max threads for optimal performance</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>clifpy/clif_orchestrator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-961"> 961</a></span>
<span class="normal"><a href="#__codelineno-0-962"> 962</a></span>
<span class="normal"><a href="#__codelineno-0-963"> 963</a></span>
<span class="normal"><a href="#__codelineno-0-964"> 964</a></span>
<span class="normal"><a href="#__codelineno-0-965"> 965</a></span>
<span class="normal"><a href="#__codelineno-0-966"> 966</a></span>
<span class="normal"><a href="#__codelineno-0-967"> 967</a></span>
<span class="normal"><a href="#__codelineno-0-968"> 968</a></span>
<span class="normal"><a href="#__codelineno-0-969"> 969</a></span>
<span class="normal"><a href="#__codelineno-0-970"> 970</a></span>
<span class="normal"><a href="#__codelineno-0-971"> 971</a></span>
<span class="normal"><a href="#__codelineno-0-972"> 972</a></span>
<span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-961" name="__codelineno-0-961"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_sys_resource_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">print_summary</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a><span class="sd">    Get system resource information including CPU, memory, and practical thread limits.</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a><span class="sd">    print_summary : bool, default=True</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a><span class="sd">        Whether to print a formatted summary</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a><span class="sd">    -------</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a><span class="sd">    Dict[str, Any]</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a><span class="sd">        Dictionary containing system resource information:</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a><span class="sd">        - cpu_count_physical: Number of physical CPU cores</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a><span class="sd">        - cpu_count_logical: Number of logical CPU cores</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a><span class="sd">        - cpu_usage_percent: Current CPU usage percentage</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a><span class="sd">        - memory_total_gb: Total RAM in GB</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a><span class="sd">        - memory_available_gb: Available RAM in GB</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a><span class="sd">        - memory_used_gb: Used RAM in GB</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a><span class="sd">        - memory_usage_percent: Memory usage percentage</span>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a><span class="sd">        - process_threads: Number of threads used by current process</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a><span class="sd">        - max_recommended_threads: Recommended max threads for optimal performance</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a>    <span class="c1"># Get current process</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a>    <span class="n">current_process</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">Process</span><span class="p">()</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a>    <span class="c1"># CPU information</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a>    <span class="n">cpu_count_physical</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">(</span><span class="n">logical</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a>    <span class="n">cpu_count_logical</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">(</span><span class="n">logical</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a>    <span class="n">cpu_usage_percent</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">cpu_percent</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a>    <span class="c1"># Memory information</span>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a>    <span class="n">memory</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">virtual_memory</span><span class="p">()</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a>    <span class="n">memory_total_gb</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">total</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a>    <span class="n">memory_available_gb</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">available</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a>    <span class="n">memory_used_gb</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">used</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a>    <span class="n">memory_usage_percent</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">percent</span>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a>    <span class="c1"># Thread information</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>    <span class="n">process_threads</span> <span class="o">=</span> <span class="n">current_process</span><span class="o">.</span><span class="n">num_threads</span><span class="p">()</span>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a>    <span class="n">max_recommended_threads</span> <span class="o">=</span> <span class="n">cpu_count_physical</span>  <span class="c1"># Conservative recommendation</span>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a>    <span class="n">resource_info</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>        <span class="s1">&#39;cpu_count_physical&#39;</span><span class="p">:</span> <span class="n">cpu_count_physical</span><span class="p">,</span>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a>        <span class="s1">&#39;cpu_count_logical&#39;</span><span class="p">:</span> <span class="n">cpu_count_logical</span><span class="p">,</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a>        <span class="s1">&#39;cpu_usage_percent&#39;</span><span class="p">:</span> <span class="n">cpu_usage_percent</span><span class="p">,</span>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a>        <span class="s1">&#39;memory_total_gb&#39;</span><span class="p">:</span> <span class="n">memory_total_gb</span><span class="p">,</span>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a>        <span class="s1">&#39;memory_available_gb&#39;</span><span class="p">:</span> <span class="n">memory_available_gb</span><span class="p">,</span>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>        <span class="s1">&#39;memory_used_gb&#39;</span><span class="p">:</span> <span class="n">memory_used_gb</span><span class="p">,</span>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a>        <span class="s1">&#39;memory_usage_percent&#39;</span><span class="p">:</span> <span class="n">memory_usage_percent</span><span class="p">,</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a>        <span class="s1">&#39;process_threads&#39;</span><span class="p">:</span> <span class="n">process_threads</span><span class="p">,</span>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a>        <span class="s1">&#39;max_recommended_threads&#39;</span><span class="p">:</span> <span class="n">max_recommended_threads</span>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a>    <span class="p">}</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a>    <span class="k">if</span> <span class="n">print_summary</span><span class="p">:</span>
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;SYSTEM RESOURCES&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CPU Cores (Physical): </span><span class="si">{</span><span class="n">cpu_count_physical</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CPU Cores (Logical):  </span><span class="si">{</span><span class="n">cpu_count_logical</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CPU Usage:            </span><span class="si">{</span><span class="n">cpu_usage_percent</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total RAM:            </span><span class="si">{</span><span class="n">memory_total_gb</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> GB&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Available RAM:        </span><span class="si">{</span><span class="n">memory_available_gb</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> GB&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Used RAM:             </span><span class="si">{</span><span class="n">memory_used_gb</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> GB&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Memory Usage:         </span><span class="si">{</span><span class="n">memory_usage_percent</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Process Threads:      </span><span class="si">{</span><span class="n">process_threads</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Max Recommended:      </span><span class="si">{</span><span class="n">max_recommended_threads</span><span class="si">}</span><span class="s2"> threads&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RECOMMENDATION: Use </span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">cpu_count_physical</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">cpu_count_physical</span><span class="si">}</span><span class="s2"> threads for optimal performance&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(Based on </span><span class="si">{</span><span class="n">cpu_count_physical</span><span class="si">}</span><span class="s2"> physical CPU cores)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a>    <span class="k">return</span> <span class="n">resource_info</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="clifpy.clif_orchestrator.ClifOrchestrator.get_tables_obj_list" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_tables_obj_list</span>


<a href="#clifpy.clif_orchestrator.ClifOrchestrator.get_tables_obj_list" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_tables_obj_list</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Return list of loaded table objects.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of loaded table objects</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>clifpy/clif_orchestrator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-356" name="__codelineno-0-356"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_tables_obj_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">:</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">    Return list of loaded table objects.</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">    -------</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="sd">    List</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">        List of loaded table objects</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>    <span class="n">table_objects</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>    <span class="k">for</span> <span class="n">table_name</span> <span class="ow">in</span> <span class="n">TABLE_CLASSES</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>        <span class="n">table_obj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table_name</span><span class="p">)</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>        <span class="k">if</span> <span class="n">table_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>            <span class="n">table_objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">table_obj</span><span class="p">)</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>    <span class="k">return</span> <span class="n">table_objects</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="clifpy.clif_orchestrator.ClifOrchestrator.initialize" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">initialize</span>


<a href="#clifpy.clif_orchestrator.ClifOrchestrator.initialize" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">initialize</span><span class="p">(</span><span class="n">tables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initialize specified tables with optional filtering and column selection.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tables</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of table names to load. Defaults to ['patient'].</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sample_size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of rows to load for each table.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>columns</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.List">List</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping table names to lists of columns to load.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filters</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Dict">Dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping table names to filter dictionaries.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>clifpy/clif_orchestrator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="k">def</span><span class="w"> </span><span class="nf">initialize</span><span class="p">(</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>    <span class="n">tables</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>    <span class="n">sample_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>    <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>    <span class="n">filters</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="p">):</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">    Initialize specified tables with optional filtering and column selection.</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">    tables : List[str], optional</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">        List of table names to load. Defaults to [&#39;patient&#39;].</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">    sample_size : int, optional</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">        Number of rows to load for each table.</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">    columns : Dict[str, List[str]], optional</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">        Dictionary mapping table names to lists of columns to load.</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">    filters : Dict[str, Dict], optional</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">        Dictionary mapping table names to filter dictionaries.</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>    <span class="k">if</span> <span class="n">tables</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>        <span class="n">tables</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;patient&#39;</span><span class="p">]</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>    <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">tables</span><span class="p">:</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>        <span class="c1"># Get table-specific columns and filters if provided</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>        <span class="n">table_columns</span> <span class="o">=</span> <span class="n">columns</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">table</span><span class="p">)</span> <span class="k">if</span> <span class="n">columns</span> <span class="k">else</span> <span class="kc">None</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>        <span class="n">table_filters</span> <span class="o">=</span> <span class="n">filters</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">table</span><span class="p">)</span> <span class="k">if</span> <span class="n">filters</span> <span class="k">else</span> <span class="kc">None</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">load_table</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">,</span> <span class="n">table_columns</span><span class="p">,</span> <span class="n">table_filters</span><span class="p">)</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>    <span class="c1"># Perform encounter stitching if enabled</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stitch_encounter</span><span class="p">:</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">run_stitch_encounters</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="clifpy.clif_orchestrator.ClifOrchestrator.load_table" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">load_table</span>


<a href="#clifpy.clif_orchestrator.ClifOrchestrator.load_table" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">load_table</span><span class="p">(</span><span class="n">table_name</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Load table data and create table object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the table to load</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sample_size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of rows to load</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>columns</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specific columns to load</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filters</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filters to apply when loading</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="            clifpy.tables.patient.Patient" href="../tables/#clifpy.tables.patient.Patient">Patient</a>, <a class="autorefs autorefs-internal" title="            clifpy.tables.hospitalization.Hospitalization" href="../tables/#clifpy.tables.hospitalization.Hospitalization">Hospitalization</a>, <a class="autorefs autorefs-internal" title="            clifpy.tables.adt.Adt" href="../tables/#clifpy.tables.adt.Adt">Adt</a>, <a class="autorefs autorefs-internal" title="            clifpy.tables.labs.Labs" href="../tables/#clifpy.tables.labs.Labs">Labs</a>, <a class="autorefs autorefs-internal" title="            clifpy.tables.vitals.Vitals" href="../tables/#clifpy.tables.vitals.Vitals">Vitals</a>, <a class="autorefs autorefs-internal" title="            clifpy.tables.medication_admin_continuous.MedicationAdminContinuous" href="../tables/#clifpy.tables.medication_admin_continuous.MedicationAdminContinuous">MedicationAdminContinuous</a>, <a class="autorefs autorefs-internal" title="            clifpy.tables.patient_assessments.PatientAssessments" href="../tables/#clifpy.tables.patient_assessments.PatientAssessments">PatientAssessments</a>, <a class="autorefs autorefs-internal" title="            clifpy.tables.respiratory_support.RespiratorySupport" href="../tables/#clifpy.tables.respiratory_support.RespiratorySupport">RespiratorySupport</a>, <a class="autorefs autorefs-internal" title="            clifpy.tables.position.Position" href="../tables/#clifpy.tables.position.Position">Position</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The loaded table object</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>clifpy/clif_orchestrator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="k">def</span><span class="w"> </span><span class="nf">load_table</span><span class="p">(</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>    <span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>    <span class="n">sample_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>    <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>    <span class="n">filters</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Patient</span><span class="p">,</span> <span class="n">Hospitalization</span><span class="p">,</span> <span class="n">Adt</span><span class="p">,</span> <span class="n">Labs</span><span class="p">,</span> <span class="n">Vitals</span><span class="p">,</span> <span class="n">MedicationAdminContinuous</span><span class="p">,</span> <span class="n">MedicationAdminIntermittent</span><span class="p">,</span> <span class="n">PatientAssessments</span><span class="p">,</span> <span class="n">RespiratorySupport</span><span class="p">,</span> <span class="n">Position</span><span class="p">,</span> <span class="n">HospitalDiagnosis</span><span class="p">,</span> <span class="n">MicrobiologyCulture</span><span class="p">,</span> <span class="n">CrrtTherapy</span><span class="p">,</span> <span class="n">PatientProcedures</span><span class="p">,</span> <span class="n">MicrobiologySusceptibility</span><span class="p">,</span> <span class="n">EcmoMcs</span><span class="p">,</span> <span class="n">MicrobiologyNonculture</span><span class="p">,</span> <span class="n">CodeStatus</span><span class="p">]:</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">    Load table data and create table object.</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">    table_name : str</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">        Name of the table to load</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">    sample_size : int, optional</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">        Number of rows to load</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">    columns : List[str], optional</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">        Specific columns to load</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">    filters : Dict, optional</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">        Filters to apply when loading</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">    -------</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">    Union[Patient, Hospitalization, Adt, Labs, Vitals, MedicationAdminContinuous, PatientAssessments, RespiratorySupport, Position]</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">        The loaded table object</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>    <span class="k">if</span> <span class="n">table_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">TABLE_CLASSES</span><span class="p">:</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown table: </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">. Available tables: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">TABLE_CLASSES</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>    <span class="n">table_class</span> <span class="o">=</span> <span class="n">TABLE_CLASSES</span><span class="p">[</span><span class="n">table_name</span><span class="p">]</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>    <span class="n">table_object</span> <span class="o">=</span> <span class="n">table_class</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>        <span class="n">data_directory</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data_directory</span><span class="p">,</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>        <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>        <span class="n">timezone</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timezone</span><span class="p">,</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>        <span class="n">output_directory</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">output_directory</span><span class="p">,</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="n">sample_size</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>        <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>        <span class="n">filters</span><span class="o">=</span><span class="n">filters</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>    <span class="p">)</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>    <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table_name</span><span class="p">,</span> <span class="n">table_object</span><span class="p">)</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>    <span class="k">return</span> <span class="n">table_object</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="clifpy.clif_orchestrator.ClifOrchestrator.validate_all" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">validate_all</span>


<a href="#clifpy.clif_orchestrator.ClifOrchestrator.validate_all" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">validate_all</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Run validation on all loaded tables.</p>
<p>This method runs the validate() method on each loaded table
and reports the results.</p>


            <details class="quote">
              <summary>Source code in <code>clifpy/clif_orchestrator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-386" name="__codelineno-0-386"></a><span class="k">def</span><span class="w"> </span><span class="nf">validate_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a><span class="sd">    Run validation on all loaded tables.</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a><span class="sd">    This method runs the validate() method on each loaded table</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="sd">    and reports the results.</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>    <span class="n">loaded_tables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_loaded_tables</span><span class="p">()</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">loaded_tables</span><span class="p">:</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;No tables loaded to validate&quot;</span><span class="p">)</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>        <span class="k">return</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Validating </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">loaded_tables</span><span class="p">)</span><span class="si">}</span><span class="s2"> table(s)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>    <span class="k">for</span> <span class="n">table_name</span> <span class="ow">in</span> <span class="n">loaded_tables</span><span class="p">:</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>        <span class="n">table_obj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table_name</span><span class="p">)</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Validating </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>        <span class="n">table_obj</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/Common-Longitudinal-ICU-data-Format/CLIFpy" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../js/dark-mode-default.js"></script>
      
    
  </body>
</html>